<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Paid Quiz</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="paymentScreen" class="screen">
    <h2>Quiz Access ‡§ï‡•á ‡§≤‡§ø‡§è Payment ‡§ï‡§∞‡•á‡§Ç</h2>
    <img src="qr.png" alt="Amazon Pay QR" class="qr">
    <input type="text" id="name" placeholder="‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
    <input type="text" id="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
    <input type="email" id="email" placeholder="Email ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç">
    <input type="file" id="screenshot" accept="image/*">
    <button onclick="paymentDone()">‚úÖ Submit</button>
  </div>

  <div id="quizScreen" class="screen hidden">
    <h2>Quiz ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</h2>
    <div id="quiz"></div>
    <button onclick="nextQuestion()">‡§Ö‡§ó‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤</button>
  </div>

  <div id="resultScreen" class="screen hidden">
    <h2>‡§Ü‡§™‡§ï‡§æ Score: <span id="score"></span></h2>
    <button onclick="restartQuiz()">üîÅ ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§ñ‡•á‡§≤‡•á‡§Ç</button>
  </div>

  <script>
    let questions = [];
    let current = 0, score = 0;

    async function loadQuestions() {
      const res = await fetch("questions.json");
      questions = await res.json();
      showQuestion();
    }

    function checkAccess() {
      let expiry = localStorage.getItem("paid_access");
      if (expiry && new Date(expiry) > new Date()) {
        document.getElementById("paymentScreen").classList.add("hidden");
        document.getElementById("quizScreen").classList.remove("hidden");
        loadQuestions();
      }
    }

    function paymentDone() {
      let expiry = new Date();
      expiry.setDate(expiry.getDate() + 30);
      localStorage.setItem("paid_access", expiry);
      checkAccess();
    }

    function showQuestion() {
      if (current < questions.length) {
        let q = questions[current];
        let html = <h3>${q.question}</h3>;
        q.options.forEach(opt => {
          html += <button onclick="answer('${opt}')">${opt}</button>;
        });
        document.getElementById("quiz").innerHTML = html;
      } else {
        document.getElementById("quizScreen").classList.add("hidden");
        document.getElementById("resultScreen").classList.remove("hidden");
        document.getElementById("score").innerText = score + "/" + questions.length;
      }
    }

    function answer(opt) {
      if (opt === questions[current].answer) score++;
      current++;
      showQuestion();
    }

    function nextQuestion() {
      showQuestion();
    }

    function restartQuiz() {
      current = 0;
      score = 0;
      document.getElementById("resultScreen").classList.add("hidden");
      document.getElementById("quizScreen").classList.remove("hidden");
      showQuestion();
    }

    checkAccess();
  </script>
</body>
</html>