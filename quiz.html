<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<title>‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® GK ‡§™‡•á‡§° ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Noto+Sans+Devanagari:wght@400;500;600;700;800;900&display=swap">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-analytics-compat.js"></script>
<style>
:root {
--primary: #2563eb;
--secondary: #7c3aed;
--accent: #ec4899;
--success: #047857;
--danger: #ef4444;
--warning: #f59e0b;
--light: #ffffff;
--dark: #000000;
--gray: #000000;
--gradient: linear-gradient(135deg, var(--primary), var(--secondary));
--premium-gradient: linear-gradient(135deg, #f59e0b, #ef4444);
--card-shadow: 0 10px 25px rgba(0,0,0,0.08);
--button-shadow: 0 4px 12px rgba(0,0,0,0.1);
--paid-color: #f59e0b;
--paid-gradient: linear-gradient(135deg, #f59e0b, #d97706);
--champion-gradient: linear-gradient(135deg, #FFD700, #FFA500, #FF8C00);
--champion-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
--neon-gradient: linear-gradient(135deg, #FF9500, #FF5E3A, #FF9500);
--neon-shadow: 0 0 20px rgba(255, 149, 0, 0.7), 0 0 40px rgba(255, 94, 58, 0.5);
--premium-text: 'Inter', 'Noto Sans Devanagari', sans-serif;
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Noto Sans Devanagari', 'Inter', sans-serif;
font-weight: 600;
}

body {
background: linear-gradient(135deg, #f0f9ff, #e9d5ff);
min-height: 100vh;
display: flex;
justify-content: center;
align-items: center;
padding: 0;
overflow: hidden;
position: fixed;
width: 100vw;
height: 100vh;
top: 0;
left: 0;
touch-action: none;
}

.container {
width: 100vw;
height: 100vh;
background: var(--light);
border-radius: 0;
box-shadow: 0 20px 40px rgba(0,0,0,0.15);
overflow: hidden;
display: flex;
flex-direction: column;
position: fixed;
top: 0;
left: 0;
}

.scrollable-content {
flex: 1;
overflow-y: auto;
-webkit-overflow-scrolling: touch;
scrollbar-width: none;
}

.header {
background: var(--paid-gradient);
padding: 15px;
text-align: center;
color: var(--light);
position: relative;
overflow: hidden;
flex-shrink: 0;
}

.header::before {
content: "";
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: linear-gradient(135deg, rgba(255,255,255,0.2), transparent);
z-index: 0;
}

.header-content {
position: relative;
z-index: 1;
}

.header h1 {
font-size: 24px;
font-weight: 800;
margin-bottom: 8px;
color: var(--light);
letter-spacing: -0.5px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.header p {
font-size: 14px;
font-weight: 700;
color: #ffffff;
letter-spacing: 0.2px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.content {
padding: 10px;
padding-bottom: 80px;
flex: 1;
display: flex;
flex-direction: column;
max-width: 100%;
}

.welcome-section {
background: var(--light);
border-radius: 16px;
padding: 15px;
margin-bottom: 15px;
box-shadow: var(--card-shadow);
text-align: center;
border: 1px solid rgba(0,0,0,0.05);
animation: fadeInUp 0.6s ease-out;
word-wrap: break-word;
overflow-wrap: break-word;
max-width: 100%;
}

@keyframes fadeInUp {
from {
opacity: 0;
transform: translateY(20px);
}
to {
opacity: 1;
transform: translateY(0);
}
}

.welcome-section h2 {
font-size: 20px;
font-weight: 800;
color: var(--dark);
margin-bottom: 10px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.welcome-section p {
font-size: 14px;
font-weight: 700;
color: var(--dark);
margin-bottom: 15px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.paid-badge {
display: inline-block;
background: var(--paid-gradient);
color: white;
font-size: 12px;
font-weight: 700;
padding: 4px 8px;
border-radius: 20px;
margin-bottom: 10px;
box-shadow: 0 2px 5px rgba(245, 158, 11, 0.3);
}

.features {
list-style: none;
margin-bottom: 15px;
}

.features li {
margin-bottom: 8px;
display: flex;
align-items: center;
font-size: 14px;
font-weight: 700;
color: var(--dark);
background: rgba(241, 245, 249, 0.7);
padding: 10px 12px;
border-radius: 10px;
box-shadow: 0 2px 5px rgba(0,0,0,0.03);
animation: fadeIn 0.5s ease-out;
animation-fill-mode: both;
word-wrap: break-word;
overflow-wrap: break-word;
}

.features li:nth-child(1) { animation-delay: 0.1s; }
.features li:nth-child(2) { animation-delay: 0.2s; }
.features li:nth-child(3) { animation-delay: 0.3s; }
.features li:nth-child(4) { animation-delay: 0.4s; }

@keyframes fadeIn {
from {
opacity: 0;
transform: translateX(-10px);
}
to {
opacity: 1;
transform: translateX(0);
}
}

.features li i {
margin-right: 10px;
color: var(--paid-color);
font-size: 16px;
background: rgba(245, 158, 11, 0.1);
width: 28px;
height: 28px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
flex-shrink: 0;
}

.start-btn {
background: var(--paid-gradient);
color: var(--light);
border: none;
border-radius: 12px;
padding: 12px 18px;
font-size: 15px;
font-weight: 700;
cursor: pointer;
width: 100%;
transition: all 0.3s ease;
box-shadow: var(--button-shadow);
margin-bottom: 10px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
}

.start-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

.quiz-section {
display: none;
background: var(--light);
border-radius: 16px;
padding: 10px;
margin-bottom: 15px;
box-shadow: var(--card-shadow);
border: 1px solid rgba(0,0,0,0.05);
position: relative;
animation: fadeInUp 0.5s ease-out;
flex: 1;
display: flex;
flex-direction: column;
width: 100%;
max-width: 100%;
}

.question-container {
flex: 1;
display: flex;
flex-direction: column;
width: 100%;
}

.question {
font-size: 16px;
font-weight: 700;
color: var(--dark);
margin-bottom: 10px;
background: rgba(241, 245, 249, 0.7);
padding: 12px;
border-radius: 10px;
box-shadow: 0 2px 5px rgba(0,0,0,0.03);
line-height: 1.5;
word-wrap: break-word;
overflow-wrap: break-word;
border-left: 4px solid var(--paid-color);
width: 100%;
}

.options {
list-style: none;
flex: 1;
display: flex;
flex-direction: column;
justify-content: space-between;
width: 100%;
}

.options li {
background: linear-gradient(135deg, #0d9488, #4b5563);
padding: 14px 18px;
margin-bottom: 10px;
border-radius: 20px;
cursor: pointer;
transition: all 0.3s ease;
font-size: 16px;
font-weight: 700;
color: #ffffff;
border: 2px solid #0d9488;
box-shadow: 0 6px 15px rgba(0,0,0,0.2);
line-height: 1.4;
word-wrap: break-word;
overflow-wrap: break-word;
display: flex;
align-items: center;
position: relative;
width: 100%;
animation: popIn 0.5s ease-out forwards;
}

@keyframes popIn {
0% {
opacity: 0;
transform: scale(0.9) translateY(15px);
}
100% {
opacity: 1;
transform: scale(1) translateY(0);
}
}

.options li:hover {
background: linear-gradient(135deg, #14b8a6, #6b7280);
border: 2px solid #14b8a6;
transform: scale(1.03);
box-shadow: 0 8px 20px rgba(20, 184, 166, 0.3);
}

.options li.correct {
background: linear-gradient(135deg, #10b981, #047857);
border: 2px solid #10b981;
color: #ffffff;
font-weight: 800;
box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
animation: pop3D 0.4s ease-out forwards;
}

.options li.correct::after {
content: "\f00c";
font-family: "Font Awesome 6 Free";
font-weight: 900;
margin-left: auto;
font-size: 18px;
color: #ffffff;
}

.options li.incorrect {
background: linear-gradient(135deg, #f87171, #ef4444);
border: 2px solid #f87171;
color: #ffffff;
font-weight: 800;
box-shadow: 0 10px 25px rgba(239, 68, 68, 0.4);
animation: pop3D 0.4s ease-out forwards;
}

.options li.incorrect::after {
content: "\f00d";
font-family: "Font Awesome 6 Free";
font-weight: 900;
margin-left: auto;
font-size: 18px;
}

.options li.selected {
background: linear-gradient(135deg, #6366f1, #8b5cf6);
border: 2px solid #6366f1;
transform: scale(1.02);
box-shadow: 0 8px 20px rgba(99, 102, 241, 0.3);
}

@keyframes pop3D {
0% {
transform: perspective(600px) rotateX(0deg) scale(1);
box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}
50% {
transform: perspective(600px) rotateX(10deg) scale(1.05);
box-shadow: 0 12px 30px rgba(0,0,0,0.3);
}
100% {
transform: perspective(600px) rotateX(0deg) scale(1);
box-shadow: 0 10px 25px rgba(0,0,0,0.4);
}
}

.result {
margin-top: 10px;
font-size: 14px;
font-weight: 700;
text-align: center;
display: none;
padding: 12px;
border-radius: 10px;
line-height: 1.4;
word-wrap: break-word;
overflow-wrap: break-word;
width: 100%;
}

.result.success {
color: var(--success);
background: rgba(4, 120, 87, 0.1);
border: 1px solid rgba(4, 120, 87, 0.2);
}

.result.error {
color: var(--danger);
background: rgba(239, 68, 68, 0.1);
border: 1px solid rgba(239, 68, 68, 0.2);
}

.navigation-buttons {
display: flex;
gap: 10px;
margin-top: 10px;
width: 100%;
}

.prev-btn, .next-btn {
background: var(--paid-gradient);
color: var(--light);
border: none;
border-radius: 12px;
padding: 12px;
font-size: 15px;
font-weight: 700;
cursor: pointer;
flex: 1;
display: none;
box-shadow: var(--button-shadow);
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
}

.prev-btn {
background: linear-gradient(135deg, #6b7280, #4b5563);
}

.prev-btn:hover, .next-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

.prev-btn:hover {
box-shadow: 0 6px 16px rgba(107, 114, 128, 0.25);
}

.prev-btn:disabled, .next-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
transform: none;
}

.offline-section, .error-section {
text-align: center;
padding: 15px;
background: var(--light);
border-radius: 16px;
box-shadow: var(--card-shadow);
margin: 15px 0;
border: 1px solid rgba(0,0,0,0.05);
word-wrap: break-word;
overflow-wrap: break-word;
width: 100%;
}

.custom-design {
width: 120px;
height: 120px;
margin: 0 auto 10px;
border-radius: 16px;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
color: var(--light);
font-size: 18px;
font-weight: 700;
text-align: center;
line-height: 1.3;
}

.offline-section .custom-design {
background: var(--gray);
}

.error-section .custom-design {
background: var(--danger);
}

.offline-message, .error-message {
font-size: 14px;
font-weight: 700;
color: var(--dark);
background: rgba(241, 245, 249, 0.7);
padding: 12px;
border-radius: 10px;
box-shadow: 0 2px 5px rgba(0,0,0,0.03);
word-wrap: break-word;
overflow-wrap: break-word;
width: 100%;
}

.progress-bar {
height: 5px;
background: rgba(0,0,0,0.05);
border-radius: 3px;
margin: 10px 0;
overflow: hidden;
width: 100%;
}

.progress {
height: 100%;
background: var(--paid-gradient);
border-radius: 3px;
width: 0%;
transition: width 0.3s ease;
}

.score-display {
margin: 10px 0;
background: var(--light);
color: var(--dark);
font-size: 13px;
font-weight: 700;
padding: 8px 10px;
border-radius: 25px;
box-shadow: var(--button-shadow);
display: none;
border: 1px solid rgba(0,0,0,0.08);
text-align: center;
width: 100%;
}

.error-overlay {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100vw;
height: 100vh;
background: rgba(0, 0, 0, 0.7);
z-index: 3000;
align-items: center;
justify-content: center;
flex-direction: column;
}

.error-container {
background: var(--light);
padding: 15px;
border-radius: 16px;
box-shadow: var(--card-shadow);
text-align: center;
max-width: 90%;
width: 100%;
max-width: 280px;
}

.error-image {
width: 100px;
height: 100px;
background: var(--danger);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 auto 10px;
color: var(--light);
font-size: 36px;
}

.error-message {
font-size: 14px;
font-weight: 700;
color: var(--dark);
margin-bottom: 10px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.retry-btn {
background: var(--paid-gradient);
color: var(--light);
border: none;
border-radius: 12px;
padding: 10px 18px;
font-size: 15px;
font-weight: 700;
cursor: pointer;
width: 100%;
box-shadow: var(--button-shadow);
}

.retry-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

.score-section {
display: none;
background: var(--light);
border-radius: 16px;
padding: 15px;
margin: 15px 0;
box-shadow: var(--card-shadow);
border: 1px solid rgba(0,0,0,0.05);
text-align: center;
animation: fadeInUp 0.6s ease-out;
flex: 1;
flex-direction: column;
width: 100%;
}

.score-section h2 {
font-size: 20px;
font-weight: 800;
color: var(--dark);
margin-bottom: 10px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
word-wrap: break-word;
overflow-wrap: break-word;
}

.score-details {
font-size: 14px;
font-weight: 600;
color: var(--dark);
margin-bottom: 15px;
background: rgba(241, 245, 249, 0.7);
padding: 12px;
border-radius: 10px;
line-height: 1.5;
word-wrap: break-word;
overflow-wrap: break-word;
width: 100%;
}

.score-circle {
width: 100px;
height: 100px;
background: var(--paid-gradient);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 auto 10px;
color: var(--light);
font-size: 24px;
font-weight: 800;
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.restart-btn {
background: var(--paid-gradient);
color: var(--light);
border: none;
border-radius: 12px;
padding: 12px 18px;
font-size: 15px;
font-weight: 700;
cursor: pointer;
width: 100%;
margin-top: 10px;
box-shadow: var(--button-shadow);
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
}

.restart-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

.loading-container {
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
height: 200px;
}

.spinner {
width: 50px;
height: 50px;
border: 5px solid rgba(245, 158, 11, 0.2);
border-top: 5px solid var(--paid-color);
border-radius: 50%;
animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
to { transform: rotate(360deg); }
}

.offline-image-container {
width: 180px;
height: 180px;
margin: 0 auto 20px;
position: relative;
display: flex;
align-items: center;
justify-content: center;
}

.offline-image {
width: 100%;
height: 100%;
border-radius: 50%;
background: linear-gradient(135deg, #4b5563, #1f2937);
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
position: relative;
overflow: hidden;
animation: pulse 2s infinite ease-in-out;
}

@keyframes pulse {
0% { transform: scale(1); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); }
50% { transform: scale(1.05); box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3); }
100% { transform: scale(1); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); }
}

.offline-image::before {
content: "";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: linear-gradient(
45deg,
transparent 30%,
rgba(255, 255, 255, 0.1) 50%,
transparent 70%
);
animation: shine 3s infinite linear;
}

@keyframes shine {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

.offline-icon {
font-size: 70px;
color: #ffffff;
position: relative;
z-index: 2;
animation: float 3s infinite ease-in-out;
}

@keyframes float {
0%, 100% { transform: translateY(0); }
50% { transform: translateY(-10px); }
}

.offline-waves {
position: absolute;
bottom: 0;
left: 0;
width: 100%;
height: 40px;
display: flex;
justify-content: space-between;
padding: 0 10px;
}

.wave {
width: 10px;
height: 10px;
border-radius: 50%;
background: rgba(255, 255, 255, 0.7);
animation: wave 1.5s infinite ease-in-out;
}

.wave:nth-child(2) { animation-delay: 0.2s; }
.wave:nth-child(3) { animation-delay: 0.4s; }
.wave:nth-child(4) { animation-delay: 0.6s; }
.wave:nth-child(5) { animation-delay: 0.8s; }

@keyframes wave {
0%, 100% { transform: translateY(0); opacity: 0.7; }
50% { transform: translateY(-15px); opacity: 1; }
}

/* Premium Leaderboard Styles */
.leaderboard-section {
display: none;
background: var(--light);
border-radius: 16px;
padding: 15px;
margin: 15px 0;
box-shadow: var(--card-shadow);
border: 1px solid rgba(0,0,0,0.05);
animation: fadeInUp 0.7s ease-out;
width: 100%;
background: linear-gradient(145deg, #ffffff, #fff8e1);
overflow: hidden;
position: relative;
}

.leaderboard-header {
display: flex;
align-items: center;
justify-content: space-between;
margin-bottom: 15px;
padding-bottom: 10px;
border-bottom: 2px solid rgba(245, 158, 11, 0.1);
}

.leaderboard-title {
display: flex;
align-items: center;
gap: 10px;
}

.leaderboard-title h2 {
font-size: 20px;
font-weight: 800;
color: var(--dark);
}

.leaderboard-date {
font-size: 12px;
font-weight: 600;
color: var(--paid-color);
background: rgba(245, 158, 11, 0.1);
padding: 5px 10px;
border-radius: 20px;
}

/* Enhanced User Rank Section */
.current-user-rank {
background: linear-gradient(135deg, #fff8e1, #ffecb3);
border-radius: 15px;
padding: 12px;
margin-bottom: 15px;
box-shadow: 0 4px 12px rgba(245, 158, 11, 0.1);
display: flex;
align-items: center;
justify-content: space-between;
border: 2px solid rgba(245, 158, 11, 0.2);
position: relative;
overflow: hidden;
}

.current-user-rank::before {
content: "";
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: linear-gradient(135deg, rgba(245, 158, 11, 0.05), rgba(239, 68, 68, 0.05));
z-index: 0;
}

.current-user-info {
display: flex;
align-items: center;
gap: 12px;
position: relative;
z-index: 1;
}

.current-user-avatar {
width: 40px;
height: 40px;
border-radius: 50%;
background: var(--paid-gradient);
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: 700;
font-size: 16px;
box-shadow: 0 4px 8px rgba(245, 158, 11, 0.2);
}

.current-user-details h3 {
font-size: 16px;
font-weight: 700;
color: var(--dark);
margin: 0;
}

.current-user-details p {
font-size: 12px;
color: var(--paid-color);
margin: 0;
}

.current-user-rank-badge {
background: var(--paid-gradient);
color: white;
width: 30px;
height: 30px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: 700;
font-size: 14px;
box-shadow: 0 4px 8px rgba(245, 158, 11, 0.2);
position: relative;
z-index: 1;
}

/* Divider between user rank and champions list */
.leaderboard-divider {
display: flex;
align-items: center;
margin: 15px 0;
gap: 10px;
}

.leaderboard-divider-line {
flex: 1;
height: 2px;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.2), rgba(239, 68, 68, 0.2));
border-radius: 2px;
}

.leaderboard-divider-text {
font-size: 12px;
font-weight: 600;
color: var(--paid-color);
padding: 0 10px;
white-space: nowrap;
}

/* Champions List Section */
.champions-section {
margin-top: 10px;
}

.champions-header {
display: flex;
align-items: center;
justify-content: center;
margin-bottom: 10px;
gap: 8px;
}

.champions-header i {
color: #facc15;
font-size: 18px;
}

.champions-header h3 {
font-size: 16px;
font-weight: 700;
color: var(--dark);
margin: 0;
}

/* Premium Scrolling Container - App-like Experience */
.leaderboard-scroll-container {
position: relative;
height: 400px;
overflow: hidden;
border-radius: 12px;
background: linear-gradient(145deg, #ffffff, #fff8e1);
box-shadow: inset 0 2px 10px rgba(245, 158, 11, 0.05);
margin-bottom: 15px;
touch-action: pan-y;
}

.leaderboard-scroll-content {
height: 100%;
overflow-y: auto;
overflow-x: hidden;
-webkit-overflow-scrolling: touch;
scroll-behavior: smooth;
padding: 10px 0;
position: relative;
}

/* Custom Scrollbar - App-like */
.leaderboard-scroll-content::-webkit-scrollbar {
width: 3px;
}

.leaderboard-scroll-content::-webkit-scrollbar-track {
background: transparent;
}

.leaderboard-scroll-content::-webkit-scrollbar-thumb {
background: rgba(245, 158, 11, 0.5);
border-radius: 3px;
}

.leaderboard-scroll-content::-webkit-scrollbar-thumb:hover {
background: rgba(245, 158, 11, 0.7);
}

/* Scroll Indicators - Subtle */
.scroll-indicator {
position: absolute;
left: 0;
width: 100%;
height: 20px;
z-index: 5;
pointer-events: none;
opacity: 0.7;
}

.scroll-indicator-top {
top: 0;
background: linear-gradient(to bottom, rgba(255, 248, 225, 0.8), rgba(255, 248, 225, 0));
}

.scroll-indicator-bottom {
bottom: 0;
background: linear-gradient(to top, rgba(255, 248, 225, 0.8), rgba(255, 248, 225, 0));
}

/* Pull to Refresh - App-like */
.pull-to-refresh {
position: absolute;
top: -60px;
left: 0;
width: 100%;
height: 60px;
display: flex;
align-items: center;
justify-content: center;
background: linear-gradient(135deg, #fff8e1, #ffecb3);
border-radius: 12px 12px 0 0;
transition: transform 0.3s ease;
z-index: 6;
}

.pull-to-refresh.active {
transform: translateY(60px);
}

.pull-to-refresh-icon {
font-size: 24px;
color: var(--paid-color);
animation: spin 1.5s infinite linear;
}

/* Leaderboard List */
.leaderboard-list {
list-style: none;
padding: 0;
margin: 0;
}

.leaderboard-item {
display: flex;
align-items: center;
padding: 12px;
margin-bottom: 10px;
background: rgba(255, 248, 225, 0.8);
border-radius: 12px;
box-shadow: 0 3px 6px rgba(245, 158, 11, 0.05);
transition: all 0.3s ease;
position: relative;
transform: translateZ(0);
backface-visibility: hidden;
animation: fadeInUp 0.5s ease-out forwards;
}

.leaderboard-item.current-user {
background: linear-gradient(135deg, #fff8e1, #ffecb3);
border: 1px solid rgba(245, 158, 11, 0.2);
}

.leaderboard-item:hover {
transform: translateY(-2px);
box-shadow: 0 6px 12px rgba(245, 158, 11, 0.1);
}

/* Premium Leaderboard Rank Styles - Enhanced */
.leaderboard-rank {
width: 36px;
height: 36px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-weight: 800;
margin-right: 15px;
flex-shrink: 0;
position: relative;
overflow: hidden;
box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
transition: all 0.3s ease;
}

/* First rank - Premium Gold */
.rank-1 {
background: linear-gradient(135deg, #FFD700, #FFC107, #FFD700);
color: #333;
box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5), 0 0 20px rgba(255, 215, 0, 0.3);
animation: goldPulse 2s infinite alternate;
font-size: 18px;
border: 2px solid #FFD700;
}

.rank-1::before {
content: "";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: linear-gradient(
45deg,
transparent 30%,
rgba(255, 255, 255, 0.3) 50%,
transparent 70%
);
animation: shine 3s infinite linear;
}

/* Second rank - Premium Silver */
.rank-2 {
background: linear-gradient(135deg, #E0E0E0, #BDBDBD, #E0E0E0);
color: #333;
box-shadow: 0 6px 20px rgba(192, 192, 192, 0.4), 0 0 20px rgba(192, 192, 192, 0.2);
animation: silverPulse 2s infinite alternate;
font-size: 18px;
border: 2px solid #E0E0E0;
}

.rank-2::before {
content: "";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: linear-gradient(
45deg,
transparent 30%,
rgba(255, 255, 255, 0.2) 50%,
transparent 70%
);
animation: shine 3s infinite linear;
}

/* Third rank - Premium Bronze */
.rank-3 {
background: linear-gradient(135deg, #CD7F32, #8B4513, #CD7F32);
color: #FFF;
box-shadow: 0 6px 20px rgba(205, 127, 50, 0.4), 0 0 20px rgba(205, 127, 50, 0.2);
animation: bronzePulse 2s infinite alternate;
font-size: 18px;
border: 2px solid #CD7F32;
}

.rank-3::before {
content: "";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: linear-gradient(
45deg,
transparent 30%,
rgba(255, 255, 255, 0.2) 50%,
transparent 70%
);
animation: shine 3s infinite linear;
}

/* Other ranks - Premium Yellow */
.rank-other {
background: linear-gradient(135deg, #FFD700, #FFC107, #FFD700);
color: #333;
box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3), 0 0 15px rgba(255, 215, 0, 0.2);
animation: yellowPulse 2s infinite alternate;
font-size: 16px;
border: 2px solid #FFD700;
}

.rank-other::before {
content: "";
position: absolute;
top: -50%;
left: -50%;
width: 200%;
height: 200%;
background: linear-gradient(
45deg,
transparent 30%,
rgba(255, 255, 255, 0.2) 50%,
transparent 70%
);
animation: shine 3s infinite linear;
}

/* Premium animations for ranks */
@keyframes goldPulse {
0% {
transform: scale(1);
box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5), 0 0 20px rgba(255, 215, 0, 0.3);
}
100% {
transform: scale(1.05);
box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6), 0 0 25px rgba(255, 215, 0, 0.4);
}
}

@keyframes silverPulse {
0% {
transform: scale(1);
box-shadow: 0 6px 20px rgba(192, 192, 192, 0.4), 0 0 20px rgba(192, 192, 192, 0.2);
}
100% {
transform: scale(1.05);
box-shadow: 0 8px 25px rgba(192, 192, 192, 0.5), 0 0 25px rgba(192, 192, 192, 0.3);
}
}

@keyframes bronzePulse {
0% {
transform: scale(1);
box-shadow: 0 6px 20px rgba(205, 127, 50, 0.4), 0 0 20px rgba(205, 127, 50, 0.2);
}
100% {
transform: scale(1.05);
box-shadow: 0 8px 25px rgba(205, 127, 50, 0.5), 0 0 25px rgba(205, 127, 50, 0.3);
}
}

@keyframes yellowPulse {
0% {
transform: scale(1);
box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3), 0 0 15px rgba(255, 215, 0, 0.2);
}
100% {
transform: scale(1.05);
box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4), 0 0 20px rgba(255, 215, 0, 0.3);
}
}

/* Hover effects for ranks */
.leaderboard-rank:hover {
transform: scale(1.1);
z-index: 10;
}

/* Crown icon for first rank */
.rank-1::after {
content: "üëë";
position: absolute;
top: -12px;
right: -5px;
font-size: 14px;
animation: bounce 2s infinite;
}

@keyframes bounce {
0%, 20%, 50%, 80%, 100% {
transform: translateY(0);
}
40% {
transform: translateY(-5px);
}
60% {
transform: translateY(-3px);
}
}

/* Star icons for second and third rank */
.rank-2::after {
content: "‚≠ê";
position: absolute;
top: -8px;
right: -5px;
font-size: 12px;
animation: twinkle 2s infinite;
}

.rank-3::after {
content: "‚≠ê";
position: absolute;
top: -8px;
right: -5px;
font-size: 12px;
animation: twinkle 2s infinite;
}

@keyframes twinkle {
0%, 100% {
opacity: 1;
}
50% {
opacity: 0.5;
}
}

.leaderboard-user {
flex: 1;
display: flex;
align-items: center;
gap: 10px;
}

.leaderboard-avatar {
width: 32px;
height: 32px;
border-radius: 50%;
background: linear-gradient(135deg, #f59e0b, #d97706);
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: 600;
font-size: 14px;
box-shadow: 0 3px 6px rgba(245, 158, 11, 0.2);
}

.leaderboard-details {
flex: 1;
}

.leaderboard-name {
font-weight: 600;
color: var(--dark);
font-size: 14px;
}

.leaderboard-time {
font-size: 11px;
color: var(--paid-color);
display: flex;
align-items: center;
gap: 4px;
}

.leaderboard-time i {
font-size: 10px;
}

.leaderboard-score {
display: flex;
flex-direction: column;
align-items: flex-end;
}

.score-value {
font-weight: 700;
color: var(--paid-color);
font-size: 16px;
}

.score-percentage {
font-size: 11px;
color: var(--paid-color);
}

.leaderboard-empty {
text-align: center;
padding: 30px 20px;
color: var(--paid-color);
font-weight: 600;
}

.leaderboard-toggle-btn {
background: var(--paid-gradient);
color: white;
border: none;
border-radius: 12px;
padding: 10px 16px;
font-size: 14px;
font-weight: 600;
cursor: pointer;
margin-top: 10px;
margin-bottom: 10px;
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
transition: all 0.3s ease;
box-shadow: var(--button-shadow);
}

.leaderboard-toggle-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

/* Professional Start Quiz Button in Leaderboard - Fixed */
.leaderboard-start-btn {
background: var(--paid-gradient);
color: white;
border: none;
border-radius: 12px;
padding: 12px 18px;
font-size: 15px;
font-weight: 700;
cursor: pointer;
width: 100%;
margin-top: 15px;
margin-bottom: 15px;
box-shadow: var(--button-shadow);
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
position: relative;
overflow: hidden;
transition: all 0.3s ease;
}

.leaderboard-start-btn::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
transition: 0.5s;
}

.leaderboard-start-btn:hover::before {
left: 100%;
}

.leaderboard-start-btn:hover {
transform: translateY(-3px);
box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
}

.loading-spinner {
display: flex;
justify-content: center;
align-items: center;
height: 100px;
}

.spinner {
width: 40px;
height: 40px;
border: 4px solid rgba(0, 0, 0, 0.1);
border-radius: 50%;
border-top-color: var(--paid-color);
animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
to { transform: rotate(360deg); }
}

.first-time-badge {
background: linear-gradient(135deg, #f97316, #ea580c);
color: white;
font-size: 10px;
font-weight: 700;
padding: 2px 6px;
border-radius: 10px;
margin-left: 5px;
display: inline-block;
}

.user-actions {
display: flex;
gap: 10px;
margin-top: 10px;
margin-bottom: 10px;
}

.user-action-btn {
flex: 1;
background: var(--paid-gradient);
color: white;
border: none;
border-radius: 12px;
padding: 10px;
font-size: 14px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
box-shadow: var(--button-shadow);
display: flex;
align-items: center;
justify-content: center;
gap: 8px;
position: relative;
overflow: hidden;
}

.user-action-btn::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
transition: 0.5s;
}

.user-action-btn:hover::before {
left: 100%;
}

.user-action-btn:hover {
transform: translateY(-2px);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.25);
}

.user-action-btn.secondary {
background: linear-gradient(135deg, #ef4444, #dc2626);
}

.user-action-btn.secondary:hover {
box-shadow: 0 6px 16px rgba(239, 68, 68, 0.25);
}

.countdown-timer {
text-align: center;
margin-top: 10px;
margin-bottom: 10px;
font-size: 12px;
font-weight: 600;
color: var(--paid-color);
background: rgba(245, 158, 11, 0.1);
padding: 8px;
border-radius: 12px;
}

.countdown-timer span {
color: var(--paid-color);
font-weight: 700;
}

/* Custom Notification Styles - Modified to appear at bottom */
.notification-overlay {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0);
z-index: 10000;
display: flex;
justify-content: center;
align-items: flex-end; /* Changed from center to flex-end */
pointer-events: none;
padding-bottom: 20px; /* Added padding at bottom */
}

.notification {
background: white;
border-radius: 16px;
padding: 20px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
max-width: 320px;
width: 90%;
display: flex;
align-items: center;
transform: translateY(100px); /* Changed from -100px to 100px */
opacity: 0;
transition: all 0.3s ease;
pointer-events: auto;
}

.notification.show {
transform: translateY(0);
opacity: 1;
}

.notification-icon {
width: 50px;
height: 50px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin-right: 15px;
flex-shrink: 0;
}

.notification-icon.success {
background: var(--success);
color: white;
}

.notification-icon.info {
background: var(--paid-color);
color: white;
}

.notification-icon.warning {
background: var(--warning);
color: white;
}

.notification-content {
flex: 1;
}

.notification-title {
font-size: 16px;
font-weight: 700;
color: var(--dark);
margin-bottom: 5px;
}

.notification-message {
font-size: 14px;
color: var(--gray);
line-height: 1.4;
}

.notification-close {
width: 24px;
height: 24px;
border-radius: 50%;
background: rgba(0, 0, 0, 0.1);
display: flex;
align-items: center;
justify-content: center;
margin-left: 10px;
cursor: pointer;
transition: all 0.2s ease;
}

.notification-close:hover {
background: rgba(0, 0, 0, 0.2);
}

/* Premium Rotating Button Styles */
.premium-rotating-btn-container {
display: flex;
justify-content: center;
margin-top: 20px;
margin-bottom: 15px;
perspective: 1000px;
}

.premium-rotating-btn {
position: relative;
width: 240px;
height: 70px;
transform-style: preserve-3d;
transition: transform 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
cursor: pointer;
}

.premium-rotating-btn.rotating {
animation: rotate360 1.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes rotate360 {
0% {
transform: rotateY(0deg);
}
100% {
transform: rotateY(180deg);
}
}

.premium-rotating-btn-face {
position: absolute;
width: 100%;
height: 100%;
border-radius: 35px;
display: flex;
align-items: center;
justify-content: center;
font-weight: 700;
font-size: 16px;
color: white;
backface-visibility: hidden;
overflow: hidden;
font-family: var(--premium-text);
text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.premium-rotating-btn-front {
background: var(--neon-gradient);
z-index: 2;
box-shadow: var(--neon-shadow);
}

.premium-rotating-btn-back {
background: linear-gradient(135deg, #FF9500, #FF5E3A);
transform: rotateY(180deg);
box-shadow: 0 0 20px rgba(255, 149, 0, 0.7), 0 0 40px rgba(255, 94, 58, 0.5);
}

.premium-rotating-btn-shine {
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
transition: 0.8s;
}

.premium-rotating-btn:hover .premium-rotating-btn-shine {
left: 100%;
}

.premium-rotating-btn-glow {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
border-radius: 35px;
background: rgba(255, 149, 0, 0.3);
transform: scale(0);
animation: glowPulse 2s infinite;
}

@keyframes glowPulse {
0% {
transform: scale(0);
opacity: 0.7;
}
70% {
transform: scale(1.2);
opacity: 0;
}
100% {
transform: scale(0);
opacity: 0;
}
}

.premium-rotating-btn-particles {
position: absolute;
top: 0;
left: 0;
width: 100%;
height: 100%;
border-radius: 35px;
overflow: hidden;
}

.particle {
position: absolute;
background: white;
border-radius: 50%;
opacity: 0;
}

.premium-rotating-btn-icon {
margin-right: 8px;
font-size: 18px;
}

/* Starburst Animation for Leaderboard */
.starburst-container {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
pointer-events: none;
z-index: 9998;
display: none;
}

.starburst {
position: absolute;
width: 5px;
height: 5px;
border-radius: 50%;
background: white;
box-shadow: 0 0 10px 2px rgba(255, 255, 255, 0.8);
}

@keyframes starburstAnimation {
0% {
transform: translate(0, 0) scale(0);
opacity: 1;
}
100% {
transform: translate(var(--tx), var(--ty)) scale(1);
opacity: 0;
}
}

/* Premium time display styles */
.time-badge {
display: inline-flex;
align-items: center;
gap: 4px;
background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(239, 68, 68, 0.1));
padding: 2px 6px;
border-radius: 10px;
font-size: 10px;
font-weight: 600;
color: var(--paid-color);
border: 1px solid rgba(245, 158, 11, 0.2);
}

.time-badge.recent {
background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.1));
color: var(--success);
border: 1px solid rgba(16, 185, 129, 0.2);
}

.time-badge.old {
background: linear-gradient(135deg, rgba(107, 114, 128, 0.1), rgba(75, 85, 99, 0.1));
color: var(--gray);
border: 1px solid rgba(107, 114, 128, 0.2);
}

/* Skeleton Loading for Leaderboard */
.skeleton-item {
display: flex;
align-items: center;
padding: 12px;
margin-bottom: 10px;
background: rgba(255, 248, 225, 0.8);
border-radius: 12px;
box-shadow: 0 3px 6px rgba(245, 158, 11, 0.05);
}

.skeleton-rank {
width: 36px;
height: 36px;
border-radius: 50%;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
margin-right: 15px;
}

.skeleton-avatar {
width: 32px;
height: 32px;
border-radius: 50%;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
margin-right: 10px;
}

.skeleton-details {
flex: 1;
}

.skeleton-name {
height: 14px;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
border-radius: 4px;
margin-bottom: 6px;
width: 80%;
}

.skeleton-time {
height: 11px;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
border-radius: 4px;
width: 60%;
}

.skeleton-score {
display: flex;
flex-direction: column;
align-items: flex-end;
}

.skeleton-value {
height: 16px;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
border-radius: 4px;
margin-bottom: 4px;
width: 40px;
}

.skeleton-percentage {
height: 11px;
background: linear-gradient(90deg, rgba(245, 158, 11, 0.1) 25%, rgba(245, 158, 11, 0.2) 50%, rgba(245, 158, 11, 0.1) 75%);
background-size: 200% 100%;
animation: skeleton-loading 1.5s infinite;
border-radius: 4px;
width: 30px;
}

@keyframes skeleton-loading {
0% {
background-position: 200% 0;
}
100% {
background-position: -200% 0;
}
}

/* Floating Scroll Button */
.floating-scroll-btn {
position: absolute;
bottom: 20px;
right: 20px;
width: 50px;
height: 50px;
border-radius: 50%;
background: var(--paid-gradient);
color: white;
display: flex;
align-items: center;
justify-content: center;
box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
cursor: pointer;
z-index: 10;
opacity: 0;
transform: scale(0.8);
transition: all 0.3s ease;
}

.floating-scroll-btn.visible {
opacity: 1;
transform: scale(1);
}

.floating-scroll-btn:hover {
transform: scale(1.1);
box-shadow: 0 6px 16px rgba(245, 158, 11, 0.4);
}

/* Snap Scroll for Mobile */
@media (max-width: 600px) {
.leaderboard-scroll-content {
scroll-snap-type: y mandatory;
}

.leaderboard-item {
scroll-snap-align: start;
}
}

@media (min-width: 601px) {
.header {
padding: 20px;
}
.header h1 {
font-size: 28px;
margin-bottom: 10px;
}
.header p {
font-size: 16px;
}
.content {
padding: 15px;
padding-bottom: 90px;
}
.welcome-section {
padding: 20px;
margin-bottom: 20px;
}
.welcome-section h2 {
font-size: 24px;
margin-bottom: 12px;
}
.welcome-section p {
font-size: 16px;
}
.features li {
font-size: 15px;
margin-bottom: 10px;
padding: 12px 14px;
}
.features li i {
font-size: 18px;
width: 32px;
height: 32px;
}
.start-btn, .restart-btn {
padding: 14px 20px;
font-size: 16px;
}
.quiz-section {
padding: 15px;
margin-bottom: 20px;
}
.question {
font-size: 18px;
margin-bottom: 12px;
padding: 14px;
}
.options li {
padding: 16px 20px;
margin-bottom: 12px;
font-size: 17px;
}
.result {
margin-top: 12px;
font-size: 16px;
padding: 14px;
}
.prev-btn, .next-btn {
padding: 14px;
font-size: 16px;
margin-top: 12px;
}
.offline-section, .error-section, .score-section {
padding: 20px;
margin: 20px 0;
}
.custom-design {
width: 140px;
height: 140px;
font-size: 20px;
}
.offline-message, .error-message, .score-details {
font-size: 16px;
padding: 14px;
}
.progress-bar {
height: 6px;
margin: 12px 0;
}
.score-display {
font-size: 14px;
padding: 8px 12px;
}
.score-circle {
width: 120px;
height: 120px;
font-size: 28px;
}
.offline-image-container {
width: 220px;
height: 220px;
}
.offline-icon {
font-size: 90px;
}
.leaderboard-header {
padding-bottom: 15px;
}
.leaderboard-title h2 {
font-size: 22px;
}
.leaderboard-date {
font-size: 14px;
padding: 8px 12px;
}
.current-user-rank {
padding: 15px;
}
.current-user-avatar {
width: 45px;
height: 45px;
font-size: 18px;
}
.current-user-details h3 {
font-size: 18px;
}
.current-user-details p {
font-size: 14px;
}
.current-user-rank-badge {
width: 35px;
height: 35px;
font-size: 16px;
}
.leaderboard-item {
padding: 15px;
}
.leaderboard-rank {
width: 40px;
height: 40px;
font-size: 18px;
}
.leaderboard-avatar {
width: 36px;
height: 36px;
font-size: 16px;
}
.leaderboard-name {
font-size: 16px;
}
.leaderboard-time {
font-size: 12px;
}
.score-value {
font-size: 18px;
}
.score-percentage {
font-size: 12px;
}
.premium-rotating-btn {
width: 280px;
height: 80px;
}
.premium-rotating-btn-face {
font-size: 18px;
}
.premium-rotating-btn-icon {
font-size: 20px;
}
.leaderboard-scroll-container {
height: 450px;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<div class="header-content">
<h1>‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® GK ‡§™‡•á‡§° ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º</h1>
<p>‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡§æ ‡§Ü‡§®‡§Ç‡§¶ ‡§≤‡•á‡§Ç</p>
</div>
</div>
<div class="scrollable-content">
<div class="content">
<div id="offline-section" class="offline-section" style="display: none;">
<div class="offline-image-container">
<div class="offline-image">
<svg width="200" height="200" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
<circle cx="100" cy="100" r="90" fill="#f5f7fa" stroke="#e4e7eb" stroke-width="2"/>
<g id="wifi-signal" transform="translate(100, 100)">
<path d="M -60 -20 Q 0 -60 60 -20" fill="none" stroke="#d63031" stroke-width="3" stroke-linecap="round" opacity="0.2">
<animate attributeName="opacity" values="0.2;0.8;0.2" dur="2s" repeatCount="indefinite"/>
</path>
<path d="M -40 0 Q 0 -40 40 0" fill="none" stroke="#d63031" stroke-width="3" stroke-linecap="round" opacity="0.4">
<animate attributeName="opacity" values="0.4;0.9;0.4" dur="2s" begin="0.5s" repeatCount="indefinite"/>
</path>
<path d="M -20 20 Q 0 -20 20 20" fill="none" stroke="#d63031" stroke-width="3" stroke-linecap="round" opacity="0.6">
<animate attributeName="opacity" values="0.6;1;0.6" dur="2s" begin="1s" repeatCount="indefinite"/>
</path>
<line x1="0" y1="40" x2="0" y2="60" stroke="#d63031" stroke-width="3" stroke-linecap="round">
<animate attributeName="y2" values="60;50;60" dur="2s" repeatCount="indefinite"/>
</line>
<circle cx="0" cy="70" r="5" fill="#d63031">
<animate attributeName="r" values="5;7;5" dur="2s" repeatCount="indefinite"/>
</circle>
</g>
<text x="100" y="150" text-anchor="middle" font-family="Noto Sans Devanagari, sans-serif" font-size="18" font-weight="700" fill="#d63031">
<animate attributeName="opacity" values="0.5;1;0.5" dur="2s" repeatCount="indefinite"/>
‡§ë‡§´‡§≤‡§æ‡§á‡§®
</text>
<text x="100" y="170" text-anchor="middle" font-family="Noto Sans Devanagari, sans-serif" font-size="12" font-weight="500" fill="#666">
<animate attributeName="opacity" values="0.3;0.7;0.3" dur="2s" begin="0.5s" repeatCount="indefinite"/>
‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç
</text>
</svg>
</div>
</div>
<p class="offline-message">‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ö‡•á‡§ï ‡§ï‡§∞‡•á‡§Ç ‡§î‡§∞ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç</p>
<button class="retry-btn" onclick="retry()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç</button>
</div>
<div id="error-section" class="error-section" style="display: none;">
<div class="custom-design">‚ö†Ô∏è</div>
<p class="error-message">‡§ï‡•Å‡§õ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•Å‡§à, ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç</p>
<button class="retry-btn" onclick="retry()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç</button>
</div>
<div id="online-content">
<div class="welcome-section" id="welcome-section">
<div class="paid-badge">‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£</div>
<h2><i class="fas fa-crown" style="color: #f59e0b;"></i> ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!</h2>
<p>‡§Ü‡§™‡§ï‡§æ ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§ ‡§Ö‡§¨ ‡§Ü‡§™ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§® ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ï‡§æ ‡§Ü‡§®‡§Ç‡§¶ ‡§≤‡•á ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§</p>
<ul class="features">
<li><i class="fas fa-check-circle"></i> 100+ ‡§è‡§ï‡•ç‡§∏‡§ï‡•ç‡§≤‡•Ç‡§∏‡§ø‡§µ ‡§∏‡§µ‡§æ‡§≤</li>
<li><i class="fas fa-check-circle"></i> ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</li>
<li><i class="fas fa-check-circle"></i> ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤-‡§°‡•á‡§∏‡•ç‡§ï‡§ü‡•â‡§™ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</li>
<li><i class="fas fa-check-circle"></i> ‡§Ö‡§™‡§°‡•á‡§ü‡•á‡§° ‡§ï‡§Ç‡§ü‡•á‡§Ç‡§ü</li>
</ul>
<button class="start-btn" onclick="startQuiz()">
<span>‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</span>
<i class="fas fa-arrow-right"></i>
</button>
<button class="leaderboard-toggle-btn" onclick="toggleLeaderboard()">
<i class="fas fa-trophy"></i>
<span>‡§Ü‡§ú ‡§ï‡•á ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§® ‡§¶‡•á‡§ñ‡•á‡§Ç</span>
</button>
</div>

<!-- Professional Leaderboard Section -->
<div id="leaderboard-section" class="leaderboard-section">
<div class="leaderboard-header">
<div class="leaderboard-title">
<i class="fas fa-trophy" style="color: #facc15;"></i>
<h2>‡§Ü‡§ú ‡§ï‡•á ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§®</h2>
</div>
<div class="leaderboard-date" id="leaderboard-date">‡§Ü‡§ú</div>
</div>

<!-- User Actions -->
<div class="user-actions">
<button class="user-action-btn" id="my-score-btn" onclick="showMyScore()">
<i class="fas fa-chart-line"></i>
<span>‡§Æ‡•á‡§∞‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞</span>
</button>
<button class="user-action-btn secondary" id="my-rank-btn" onclick="showMyRank()">
<i class="fas fa-medal"></i>
<span>‡§Æ‡•á‡§∞‡•Ä ‡§∞‡•à‡§Ç‡§ï</span>
</button>
</div>

<!-- Countdown Timer -->
<div class="countdown-timer" id="countdown-timer">
‡§Ö‡§ó‡§≤‡•Ä ‡§∞‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó ‡§Æ‡•á‡§Ç <span id="countdown-time">24:00:00</span> ‡§¨‡§ö‡•á ‡§π‡•à‡§Ç
</div>

<!-- Current User Rank Display -->
<div id="current-user-rank" class="current-user-rank" style="display: none;">
<div class="current-user-info">
<div class="current-user-avatar" id="current-user-avatar">U</div>
<div class="current-user-details">
<h3 id="current-user-name">‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ</h3>
<p id="current-user-score">‡§∏‡•ç‡§ï‡•ã‡§∞: 0/0</p>
</div>
</div>
<div class="current-user-rank-badge" id="current-user-rank-badge">-</div>
</div>

<!-- Divider between user rank and champions list -->
<div class="leaderboard-divider" id="leaderboard-divider" style="display: none;">
<div class="leaderboard-divider-line"></div>
<div class="leaderboard-divider-text">‡§Ü‡§ú ‡§ï‡•á ‡§ö‡•à‡§Ç‡§™‡§ø‡§Ø‡§®</div>
<div class="leaderboard-divider-line"></div>
</div>

<!-- Champions List Section -->
<div class="champions-section" id="champions-section" style="display: none;">
<div class="champions-header">
<i class="fas fa-crown"></i>
<h3>‡§ü‡•â‡§™ ‡§™‡•ç‡§∞‡§¶‡§∞‡•ç‡§∂‡§®‡§ï‡§∞‡•ç‡§§‡§æ</h3>
</div>
</div>

<!-- Premium Scrolling Container - App-like Experience -->
<div class="leaderboard-scroll-container">
<!-- Pull to Refresh -->
<div class="pull-to-refresh" id="pull-to-refresh">
<i class="fas fa-sync-alt pull-to-refresh-icon"></i>
</div>

<!-- Scroll Indicators -->
<div class="scroll-indicator scroll-indicator-top" id="scroll-indicator-top" style="display: none;"></div>
<div class="scroll-indicator scroll-indicator-bottom" id="scroll-indicator-bottom" style="display: none;"></div>

<!-- Scroll Content -->
<div class="leaderboard-scroll-content" id="leaderboard-scroll-content">
<div id="leaderboard-loading" class="loading-spinner" style="display: none;">
<div class="spinner"></div>
</div>
<ul id="leaderboard-list" class="leaderboard-list"></ul>
</div>

<!-- Floating Scroll Button -->
<div class="floating-scroll-btn" id="floating-scroll-btn" onclick="scrollToTop()">
<i class="fas fa-arrow-up"></i>
</div>
</div>

<!-- Professional Start Quiz Button in Leaderboard - Fixed -->
<button class="leaderboard-start-btn" onclick="startQuizFromLeaderboard()">
<i class="fas fa-play"></i>
<span>‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</span>
</button>
</div>

<div id="quiz-section" class="quiz-section" style="display: none;">
<div class="question-container">
<div class="question" id="question-text">‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
<div class="progress-bar">
<div class="progress" id="progress-bar"></div>
</div>
<ul class="options" id="options-list">
<div class="loading-container">
<div class="spinner"></div>
</div>
</ul>
<div id="result" class="result"></div>
<div class="score-display" id="score-display">‡§∏‡•ç‡§ï‡•ã‡§∞: <span id="score-value">0</span></div>
<div class="navigation-buttons">
<button class="prev-btn" id="prev-btn" onclick="previousQuestion()" style="display: none;">
<i class="fas fa-arrow-left"></i>
<span>‡§™‡§ø‡§õ‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤</span>
</button>
<button class="next-btn" id="next-btn" onclick="nextQuestion()" style="display: none;">
<span>‡§Ö‡§ó‡§≤‡§æ ‡§∏‡§µ‡§æ‡§≤</span>
<i class="fas fa-arrow-right"></i>
</button>
</div>
</div>
</div>
<div id="score-section" class="score-section" style="display: none;">
<div class="score-circle" id="final-score-circle">0/0</div>
<h2><i class="fas fa-trophy" style="color: #f59e0b;"></i> ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§!</h2>
<div class="score-details" id="score-details"></div>
<button class="restart-btn" onclick="restartQuiz()">
<span>‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§™‡•Å‡§®‡§É ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</span>
<i class="fas fa-redo"></i>
</button>

<!-- Premium Rotating Button -->
<div class="premium-rotating-btn-container">
<div class="premium-rotating-btn" id="premium-rotating-btn" onclick="handlePremiumBtnClick()">
<div class="premium-rotating-btn-face premium-rotating-btn-front">
<div class="premium-rotating-btn-shine"></div>
<div class="premium-rotating-btn-glow"></div>
<div class="premium-rotating-btn-particles" id="particles-container"></div>
<i class="fas fa-rocket premium-rotating-btn-icon"></i>
<span style="font-size: 18px; font-weight: 900;">‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§∞‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó ‡§¶‡•á‡§ñ‡•á‡§Ç</span>
</div>
<div class="premium-rotating-btn-face premium-rotating-btn-back">
<i class="fas fa-star premium-rotating-btn-icon"></i>
<span>‡§µ‡§ø‡§ú‡•á‡§§‡§æ ‡§ñ‡•ã‡§ú‡•á‡§Ç</span>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

<!-- Starburst Animation Container -->
<div class="starburst-container" id="starburst-container"></div>

<!-- Name Input Modal -->
<div id="name-modal-overlay" class="name-modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 9999; justify-content: center; align-items: center; animation: fadeIn 0.3s ease-out;">
<div class="name-modal" style="background: white; border-radius: 20px; padding: 20px; width: 90%; max-width: 320px; box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2); text-align: center; animation: slideUp 0.4s ease-out;">
<h3 style="font-size: 20px; font-weight: 700; color: var(--dark); margin-bottom: 15px;">‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</h3>
<p style="font-size: 14px; color: var(--gray); margin-bottom: 20px; line-height: 1.4;">‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§™‡§®‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç ‡§§‡§æ‡§ï‡§ø ‡§π‡§Æ ‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§ï‡§∞ ‡§∏‡§ï‡•á‡§Ç</p>
<input type="text" id="user-name-input" class="name-input" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" maxlength="20" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 12px; font-size: 16px; font-weight: 600; margin-bottom: 20px; transition: all 0.3s ease;">
<button class="name-submit-btn" onclick="saveUserName()" style="background: var(--paid-gradient); color: white; border: none; border-radius: 12px; padding: 12px 20px; font-size: 16px; font-weight: 600; cursor: pointer; width: 100%; transition: all 0.3s ease; box-shadow: var(--button-shadow);">‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç</button>
</div>
</div>

<div id="error-overlay" class="error-overlay">
<div class="error-container">
<div class="error-image">‚ùå</div>
<p class="error-message">‡§ï‡•Å‡§õ ‡§ó‡§°‡§º‡§¨‡§°‡§º ‡§π‡•Å‡§à, ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç!</p>
<button class="retry-btn" onclick="retry()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç</button>
</div>
</div>

<!-- Custom Notification -->
<div id="notification-overlay" class="notification-overlay">
<div class="notification" id="notification">
<div class="notification-icon" id="notification-icon">
<i class="fas fa-info"></i>
</div>
<div class="notification-content">
<div class="notification-title" id="notification-title">‡§∏‡•Ç‡§ö‡§®‡§æ</div>
<div class="notification-message" id="notification-message">‡§∏‡§Ç‡§¶‡•á‡§∂</div>
</div>
<div class="notification-close" onclick="hideNotification()">
<i class="fas fa-times"></i>
</div>
</div>
</div>

<script>
// Firebase configuration
const firebaseConfig = {
apiKey: "AIzaSyDB0mVcsgSUcM7X01xcffmRBiKWRU55u_M",
authDomain: "rajasthan-gk-quiz-41cc5.firebaseapp.com",
databaseURL: "https://rajasthan-gk-quiz-41cc5-default-rtdb.firebaseio.com",
projectId: "rajasthan-gk-quiz-41cc5",
storageBucket: "rajasthan-gk-quiz-41cc5.firebasestorage.app",
messagingSenderId: "876482514501",
appId: "1:876482514501:web:1ac10bc020591a5d931d2c",
measurementId: "G-VB140B6NCW"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const database = firebase.database();
const analytics = firebase.analytics();

let questions = [];
let currentQuestionIndex = 0;
let score = 0;
let initialScore = 0; // Track the initial score for leaderboard
let userName = '';
let userId = ''; // Unique ID for each user
let isFirstTime = true; // Track if it's the user's first time
let todayScores = [];
let isLeaderboardLoaded = false;
let countdownInterval; // For the countdown timer
let questionHistory = []; // Store history of questions and answers
let autoNextTimeout; // Timeout for auto next question
let quizStarted = false;
let quizCompleted = false; // Track if the quiz has been completed once
let lastLeaderboardDate = ''; // Track the last date leaderboard was loaded
let leaderboardToggleState = false; // Track the toggle state to prevent double clicks
let midnightResetInterval; // For midnight reset
let isRotating = false; // Track if button is currently rotating
let notificationTimeout = null; // Track notification timeout
let userAnswered = false; // Track if user has answered the current question

// Premium scrolling variables
let isPulling = false;
let pullStartY = 0;
let pullDistance = 0;
let scrollContent = null;
let scrollContainer = null;
let floatingScrollBtn = null;
let topScrollIndicator = null;
let bottomScrollIndicator = null;
let pullToRefresh = null;

// Initialize sound effects - MIT App Inventor Assets ‡§ï‡•á ‡§≤‡§ø‡§è paths
const correctSound = new Audio('file:///android_asset/correct.mp3'); // ‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨ ‡§ï‡§æ sound (assets ‡§Æ‡•á‡§Ç upload ‡§ï‡§∞‡•á‡§Ç)
const incorrectSound = new Audio('file:///android_asset/incorrect.mp3'); // ‡§ó‡§≤‡§§ ‡§ú‡§µ‡§æ‡§¨ ‡§ï‡§æ sound (assets ‡§Æ‡•á‡§Ç upload ‡§ï‡§∞‡•á‡§Ç)
const fireworksSound = new Audio('file:///android_asset/fireworks.mp3'); // ‡§™‡§ü‡§æ‡§ñ‡•á ‡§ï‡§æ sound (assets ‡§Æ‡•á‡§Ç upload ‡§ï‡§∞‡•á‡§Ç)

// Ensure audio plays after user interaction
function unlockAudio() {
correctSound.load();
incorrectSound.load();
fireworksSound.load();
document.removeEventListener('click', unlockAudio);
}
document.addEventListener('click', unlockAudio);

document.addEventListener('DOMContentLoaded', () => {
initializeQuiz();
checkUserName();
startCountdownTimer();
checkAndResetLeaderboard(); // Check if we need to reset the leaderboard
scheduleMidnightReset(); // Schedule midnight reset
createParticles(); // Create particles for the premium button
initializePremiumScrolling(); // Initialize premium scrolling
if (navigator.onLine) {
loadQuestions();
}

// Add proper event listeners for the user action buttons
document.getElementById('my-score-btn').addEventListener('click', showMyScore);
document.getElementById('my-rank-btn').addEventListener('click', showMyRank);
});

function initializeQuiz() {
// Initial network check when page loads
checkNetworkStatus();
console.log('DOM loaded, initializing paid quiz');
}

function initializePremiumScrolling() {
// Get scroll elements
scrollContent = document.getElementById('leaderboard-scroll-content');
scrollContainer = document.querySelector('.leaderboard-scroll-container');
floatingScrollBtn = document.getElementById('floating-scroll-btn');
topScrollIndicator = document.getElementById('scroll-indicator-top');
bottomScrollIndicator = document.getElementById('scroll-indicator-bottom');
pullToRefresh = document.getElementById('pull-to-refresh');

if (!scrollContent || !scrollContainer) return;

// Add scroll event listener
scrollContent.addEventListener('scroll', handleScroll);

// Add touch events for pull to refresh
scrollContent.addEventListener('touchstart', handleTouchStart, { passive: true });
scrollContent.addEventListener('touchmove', handleTouchMove, { passive: false });
scrollContent.addEventListener('touchend', handleTouchEnd);

// Add mouse events for desktop
scrollContent.addEventListener('mousedown', handleMouseDown);
scrollContent.addEventListener('mousemove', handleMouseMove);
scrollContent.addEventListener('mouseup', handleMouseUp);
scrollContent.addEventListener('mouseleave', handleMouseUp);

// Initial check for scroll indicators
updateScrollIndicators();
}

function handleScroll() {
if (!scrollContent || !scrollContainer) return;

// Update scroll indicators
updateScrollIndicators();

// Show/hide floating scroll button
if (floatingScrollBtn) {
if (scrollContent.scrollTop > 100) {
floatingScrollBtn.classList.add('visible');
} else {
floatingScrollBtn.classList.remove('visible');
}
}
}

function updateScrollIndicators() {
if (!scrollContent || !topScrollIndicator || !bottomScrollIndicator) return;

const scrollTop = scrollContent.scrollTop;
const scrollHeight = scrollContent.scrollHeight - scrollContent.clientHeight;

// Show top indicator if not at top
if (scrollTop > 10) {
topScrollIndicator.style.display = 'block';
} else {
topScrollIndicator.style.display = 'none';
}

// Show bottom indicator if not at bottom
if (scrollTop < scrollHeight - 10) {
bottomScrollIndicator.style.display = 'block';
} else {
bottomScrollIndicator.style.display = 'none';
}
}

function scrollToTop() {
if (!scrollContent) return;

scrollContent.scrollTo({
top: 0,
behavior: 'smooth'
});
}

function handleTouchStart(e) {
if (!scrollContent || scrollContent.scrollTop > 0) return;

isPulling = true;
pullStartY = e.touches[0].clientY;
}

function handleTouchMove(e) {
if (!isPulling || !pullToRefresh) return;

const currentY = e.touches[0].clientY;
pullDistance = currentY - pullStartY;

// Limit pull distance
if (pullDistance < 0) pullDistance = 0;
if (pullDistance > 120) pullDistance = 120;

// Apply transform to pull indicator
pullToRefresh.style.transform = `translateY(${pullDistance}px)`;

// Add active class if pulled enough
if (pullDistance > 80) {
pullToRefresh.classList.add('active');
} else {
pullToRefresh.classList.remove('active');
}

// Prevent default scroll behavior when pulling
if (pullDistance > 0) {
e.preventDefault();
}
}

function handleTouchEnd() {
if (!isPulling || !pullToRefresh) return;

isPulling = false;

// Reset pull indicator
pullToRefresh.style.transform = 'translateY(0)';

// If pulled enough, trigger refresh
if (pullDistance > 80) {
pullToRefresh.classList.remove('active');
refreshLeaderboard();
}

pullDistance = 0;
}

// Mouse event handlers for desktop
function handleMouseDown(e) {
if (!scrollContent || scrollContent.scrollTop > 0) return;

isPulling = true;
pullStartY = e.clientY;
}

function handleMouseMove(e) {
if (!isPulling) return;

const currentY = e.clientY;
pullDistance = currentY - pullStartY;

// Limit pull distance
if (pullDistance < 0) pullDistance = 0;
if (pullDistance > 120) pullDistance = 120;

// Apply transform to pull indicator
pullToRefresh.style.transform = `translateY(${pullDistance}px)`;

// Add active class if pulled enough
if (pullDistance > 80) {
pullToRefresh.classList.add('active');
} else {
pullToRefresh.classList.remove('active');
}
}

function handleMouseUp() {
if (!isPulling || !pullToRefresh) return;

isPulling = false;

// Reset pull indicator
pullToRefresh.style.transform = 'translateY(0)';

// If pulled enough, trigger refresh
if (pullDistance > 80) {
pullToRefresh.classList.remove('active');
refreshLeaderboard();
}

pullDistance = 0;
}

function refreshLeaderboard() {
showNotification('info', '‡§∞‡•Ä‡§´‡•ç‡§∞‡•á‡§∂ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à', '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...');
loadLeaderboardData();
}

function checkNetworkStatus() {
const offlineSection = document.getElementById('offline-section');
const errorSection = document.getElementById('error-section');
const onlineContent = document.getElementById('online-content');
const errorOverlay = document.getElementById('error-overlay');

if (!offlineSection || !errorSection || !onlineContent || !errorOverlay) {
console.error('Network status elements not found for paid quiz');
showErrorOverlay();
return;
}

if (!navigator.onLine) {
offlineSection.style.display = 'block';
errorSection.style.display = 'none';
onlineContent.style.display = 'none';
console.log('User is offline, showing offline section');
} else {
offlineSection.style.display = 'none';
errorSection.style.display = 'none';
onlineContent.style.display = 'block';
console.log('User is online, showing online content');
}
}

function checkUserName() {
// Check if user name is already saved in localStorage (permanent storage)
const savedName = localStorage.getItem('paidQuizUserName');
const savedUserId = localStorage.getItem('paidQuizUserId');

if (savedName && savedUserId) {
userName = savedName;
userId = savedUserId;
isFirstTime = false; // User has already played before
// Update the current user avatar with first letter of name
updateCurrentUserAvatar();
} else {
// Show name input modal
document.getElementById('name-modal-overlay').style.display = 'flex';
}
}

function updateCurrentUserAvatar() {
const avatar = document.getElementById('current-user-avatar');
if (avatar && userName) {
avatar.textContent = userName.charAt(0).toUpperCase();
}
}

function saveUserName() {
const nameInput = document.getElementById('user-name-input');
const enteredName = nameInput.value.trim();

if (enteredName.length < 2) {
showNotification('warning', '‡§ö‡•á‡§§‡§æ‡§µ‡§®‡•Ä', '‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡§Æ ‡§∏‡•á ‡§ï‡§Æ 2 ‡§Ö‡§ï‡•ç‡§∑‡§∞‡•ã‡§Ç ‡§ï‡§æ ‡§®‡§æ‡§Æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç');
return;
}

userName = enteredName;
// Generate a unique ID for the user (using timestamp and random number)
userId = 'paid_user_' + Date.now() + '_' + Math.floor(Math.random() * 1000);

// Save to localStorage permanently (no expiry)
localStorage.setItem('paidQuizUserName', userName);
localStorage.setItem('paidQuizUserId', userId);

document.getElementById('name-modal-overlay').style.display = 'none';
updateCurrentUserAvatar();
}

async function loadQuestions() {
const errorSection = document.getElementById('error-section');
const onlineContent = document.getElementById('online-content');
const errorOverlay = document.getElementById('error-overlay');

if (!errorSection || !onlineContent || !errorOverlay) {
console.error('Error/Online sections not found for paid quiz');
showErrorOverlay();
return;
}

try {
const repoUrl = 'https://raw.githubusercontent.com/jaatpankaj610/PAID-QUIZ/main/questions.json';
console.log('Attempting to load questions from:', repoUrl);

const response = await fetch(repoUrl, {
method: 'GET',
mode: 'cors',
cache: 'no-store',
credentials: 'omit'
});

if (!response.ok) {
throw new Error(`HTTP error! status: ${response.status}, message: ${response.statusText}`);
}

const data = await response.json();

if (!data.questions || !Array.isArray(data.questions) || data.questions.length === 0) {
throw new Error('No questions found or invalid data format');
}

questions = [];
for (let i = 0; i < data.questions.length; i++) {
const q = data.questions[i];
if (!q.question || !q.options || !Array.isArray(q.options) || q.options.length < 4 || !q.correctAnswer) {
throw new Error(`Invalid question at index ${i}: ${JSON.stringify(q)}`);
}

const correctIndex = q.options.findIndex(option => option === q.correctAnswer);
if (correctIndex === -1) {
throw new Error(`Correct answer "${q.correctAnswer}" not found in options for question at index ${i}`);
}

questions.push({
question: q.question,
options: q.options,
correct: correctIndex
});
}

console.log('Successfully loaded and converted', questions.length, 'questions');

} catch (error) {
console.error('Failed to load questions:', error);

const errorMessage = document.createElement('div');
errorMessage.className = 'error-message';
errorMessage.innerHTML = `
<strong>‡§§‡•ç‡§∞‡•Å‡§ü‡§ø:</strong> ${error.message}<br><br>
<strong>‡§∏‡§Æ‡§æ‡§ß‡§æ‡§®:</strong><br>
1. ‡§Ö‡§™‡§®‡•á GitHub ‡§∞‡§ø‡§™‡•â‡§ú‡§ø‡§ü‡§∞‡•Ä URL ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç<br>
2. questions.json ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡•Ä ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç<br>
3. ‡§á‡§Ç‡§ü‡§∞‡§®‡•á‡§ü ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡•á‡§Ç
`;

const errorContainer = document.querySelector('.error-container');
if (errorContainer) {
const oldMessage = errorContainer.querySelector('.error-message');
if (oldMessage) {
oldMessage.parentNode.removeChild(oldMessage);
}
errorContainer.insertBefore(errorMessage, errorContainer.firstChild);
}

showErrorOverlay();
if ('vibrate' in navigator) navigator.vibrate(200);
}
}

function startQuiz() {
// ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
if (!checkUserAccess()) {
return; // ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§µ‡•à‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡•á‡§Ç
}

if (!userName) {
checkUserName();
return;
}

if (!navigator.onLine) {
document.getElementById('offline-section').style.display = 'block';
document.getElementById('online-content').style.display = 'none';
return;
}

if (quizStarted) return;
quizStarted = true;

const welcomeSection = document.getElementById('welcome-section');
const quizSection = document.getElementById('quiz-section');
const scoreSection = document.getElementById('score-section');
const leaderboardSection = document.getElementById('leaderboard-section');

if (welcomeSection && quizSection && scoreSection) {
welcomeSection.style.display = 'none';
quizSection.style.display = 'block';
scoreSection.style.display = 'none';
leaderboardSection.style.display = 'none';

currentQuestionIndex = 0;
score = 0;
initialScore = 0; // Reset initial score
questionHistory = []; // Reset question history
quizCompleted = false; // Reset quiz completion flag
userAnswered = false; // Reset userAnswered flag
updateScore();

if (questions.length === 0) {
loadQuestions().then(() => {
if (questions.length > 0) {
showQuestion();
} else {
showErrorOverlay();
}
}).catch(() => {
showErrorOverlay();
});
} else {
showQuestion();
}
} else {
console.error('Quiz sections not found for paid quiz');
showErrorOverlay();
}
}

function startQuizFromLeaderboard() {
const leaderboardSection = document.getElementById('leaderboard-section');
if (leaderboardSection) {
leaderboardSection.style.display = 'none';
leaderboardToggleState = false; // Reset toggle state
}

// Reset quizStarted flag to allow starting quiz from leaderboard
quizStarted = false;

// Force reload questions to ensure they're available
questions = [];

// Start the quiz
startQuiz();
}

function updateScore() {
const scoreDisplay = document.getElementById('score-display');
const scoreValue = document.getElementById('score-value');
if (scoreDisplay && scoreValue) {
scoreValue.textContent = score;
scoreDisplay.style.display = 'block';
}
}

function updateProgressBar() {
const progressBar = document.getElementById('progress-bar');
if (progressBar) {
const progress = ((currentQuestionIndex + 1) / questions.length) * 100;
progressBar.style.width = `${progress}%`;
}
}

function showQuestion() {
// ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
if (!checkUserAccess()) {
return; // ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§µ‡•à‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡•á‡§Ç
}

const questionText = document.getElementById('question-text');
const optionsList = document.getElementById('options-list');
const result = document.getElementById('result');
const nextBtn = document.getElementById('next-btn');
const prevBtn = document.getElementById('prev-btn');

if (!questionText || !optionsList || !result || !nextBtn || !prevBtn) {
console.error('Paid quiz elements not found');
showErrorOverlay();
return;
}

if (currentQuestionIndex >= questions.length) {
showFinalScore();
return;
}

const question = questions[currentQuestionIndex];
if (!question || !question.question || !question.options || !Array.isArray(question.options) || question.options.length < 4) {
console.error('Invalid question data for paid quiz:', question);
showErrorOverlay();
return;
}

questionText.textContent = question.question;
optionsList.innerHTML = '';
result.style.display = 'none';
nextBtn.style.display = 'none';
updateProgressBar();

// Update navigation buttons
updateNavigationButtons();

// Reset the answered flag
userAnswered = false;

// Clear any existing timeout
if (autoNextTimeout) {
clearTimeout(autoNextTimeout);
}

// Check if user has already answered this question
const previousAnswer = questionHistory.find(h => h.questionIndex === currentQuestionIndex);
let previouslySelected = -1;
if (previousAnswer) {
previouslySelected = previousAnswer.selectedIndex;
userAnswered = true; // Mark as answered if previous answer exists
}

question.options.forEach((option, index) => {
const li = document.createElement('li');
li.textContent = option || '‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ó‡§æ‡§Ø‡§¨';
li.style.opacity = '0';
li.style.transform = 'scale(0.9) translateY(15px)';
li.onclick = () => checkAnswer(index);
optionsList.appendChild(li);

// If this option was previously selected, highlight it
if (index === previouslySelected) {
li.classList.add('selected');
}

// If user has already answered this question, show the correct/incorrect styling
if (previousAnswer) {
if (index === question.correct) {
li.classList.add('correct');
} else if (index === previousAnswer.selectedIndex && index !== question.correct) {
li.classList.add('incorrect');
}
// Disable further clicks if already answered
li.onclick = null;
}

setTimeout(() => {
li.style.transition = 'all 0.5s ease';
li.style.opacity = '1';
li.style.transform = 'scale(1) translateY(0)';
}, index * 100);
});

// If user has already answered this question, show the result and next button
if (previousAnswer) {
if (previousAnswer.wasCorrect) {
result.textContent = '‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨!';
result.className = 'result success';
} else {
result.textContent = `‡§ó‡§≤‡§§ ‡§ú‡§µ‡§æ‡§¨! ‡§∏‡§π‡•Ä: ${question.options[question.correct]}`;
result.className = 'result error';
}
result.style.display = 'block';

// Show next button if not on last question
if (currentQuestionIndex < questions.length - 1) {
nextBtn.style.display = 'flex';
}
}
}

function updateNavigationButtons() {
const prevBtn = document.getElementById('prev-btn');
const nextBtn = document.getElementById('next-btn');

if (!prevBtn || !nextBtn) return;

// Show previous button if not on first question
if (currentQuestionIndex > 0) {
prevBtn.style.display = 'flex';
} else {
prevBtn.style.display = 'none';
}

// Don't show next button initially - it will be shown after answering
nextBtn.style.display = 'none';
}

function previousQuestion() {
if (currentQuestionIndex > 0) {
// Clear any existing timeout
if (autoNextTimeout) {
clearTimeout(autoNextTimeout);
}

currentQuestionIndex--;
showQuestion();
}
}

function nextQuestion() {
// Clear any existing timeout
if (autoNextTimeout) {
clearTimeout(autoNextTimeout);
}

currentQuestionIndex++;
showQuestion();
}

function triggerConfetti() {
confetti({
particleCount: 200,
spread: 90,
origin: { y: 0.4 },
colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'],
shapes: ['square', 'circle', 'star'],
ticks: 300,
gravity: 0.8,
scalar: 1.2
});
setTimeout(() => {
confetti({
particleCount: 100,
spread: 70,
origin: { y: 0.6 },
colors: ['#ff0000', '#00ff00', '#0000ff', '#ffff00'],
shapes: ['square', 'circle'],
ticks: 200
});
}, 200);
}

function checkAnswer(selectedIndex) {
// If this question was already answered, don't allow re-answering
const existingAnswer = questionHistory.find(h => h.questionIndex === currentQuestionIndex);
if (existingAnswer) {
return;
}

// Prevent multiple answers to the same question
if (userAnswered) return;
userAnswered = true;

const question = questions[currentQuestionIndex];
const options = document.querySelectorAll('#options-list li');
const result = document.getElementById('result');
const nextBtn = document.getElementById('next-btn');

if (!result || !options.length || !nextBtn) {
console.error('Result or options not found for paid quiz');
showErrorOverlay();
return;
}

// Store this question in history
const wasCorrect = selectedIndex === question.correct;
questionHistory.push({
questionIndex: currentQuestionIndex,
selectedIndex: selectedIndex,
correctAnswer: question.correct,
wasCorrect: wasCorrect
});

options.forEach((option, index) => {
option.onclick = null;
if (index === question.correct) option.classList.add('correct');
if (index === selectedIndex && selectedIndex !== question.correct) option.classList.add('incorrect');
if (index === selectedIndex) option.classList.add('selected');
});

if (wasCorrect) {
score++;
// Only update initial score if this is the first time completing the quiz
if (!quizCompleted) {
initialScore++;
}
updateScore();
result.textContent = '‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨!';
result.className = 'result success';
triggerConfetti();
try {
correctSound.play().catch(e => console.error('Correct sound failed:', e));
} catch (e) {
console.error('Correct sound error:', e);
}
} else {
result.textContent = `‡§ó‡§≤‡§§ ‡§ú‡§µ‡§æ‡§¨! ‡§∏‡§π‡•Ä: ${question.options[question.correct]}`;
result.className = 'result error';
try {
incorrectSound.play().catch(e => console.error('Incorrect sound failed:', e));
} catch (e) {
console.error('Incorrect sound error:', e);
}
}

result.style.display = 'block';

if ('vibrate' in navigator) navigator.vibrate(200);

// Show next button if not on last question
if (currentQuestionIndex < questions.length - 1) {
nextBtn.style.display = 'flex';
}

// Auto move to next question after 1.5 seconds if not on last question
if (currentQuestionIndex < questions.length - 1) {
autoNextTimeout = setTimeout(() => {
nextQuestion();
}, 1500);
}
}

function showFinalScore() {
const quizSection = document.getElementById('quiz-section');
const scoreSection = document.getElementById('score-section');
const finalScoreCircle = document.getElementById('final-score-circle');
const scoreDetails = document.getElementById('score-details');

if (!quizSection || !scoreSection || !finalScoreCircle || !scoreDetails) {
console.error('Score section elements not found');
showErrorOverlay();
return;
}

quizSection.style.display = 'none';
scoreSection.style.display = 'flex';

// Mark quiz as completed
quizCompleted = true;

finalScoreCircle.textContent = `${score}/${questions.length}`;
const percentage = ((score / questions.length) * 100).toFixed(2);
scoreDetails.innerHTML = `
‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞: ${score}/${questions.length}<br>
‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§: ${percentage}%<br>
‡§∏‡§π‡•Ä ‡§ú‡§µ‡§æ‡§¨: ${score}<br>
‡§ó‡§≤‡§§ ‡§ú‡§µ‡§æ‡§¨: ${questions.length - score}<br>
‡§∏‡§Æ‡§Ø: ${new Date().toLocaleTimeString()}
`;

// Save score to Firebase (only the initial score)
saveScoreToFirebase();
}

function saveScoreToFirebase() {
if (!userName || !userId) return;

// Get current date in YYYY-MM-DD format
const today = new Date();
const dateStr = today.toISOString().split('T')[0];
const timestamp = today.getTime();

// Create new score entry with initial score (not current score)
const newScore = {
name: userName,
userId: userId,
score: initialScore, // Use initial score instead of current score
totalQuestions: questions.length,
timestamp: timestamp,
date: dateStr,
isFirstTime: isFirstTime
};

// Check if user already has a score for today
database.ref(`paidTodayScores/${dateStr}`).orderByChild('userId').equalTo(userId).once('value')
.then((snapshot) => {
if (snapshot.exists()) {
// User already has a score for today, don't update it
console.log('User already has a score for today, not updating');
} else {
// User doesn't have a score for today, create a new one
database.ref(`paidTodayScores/${dateStr}`).push(newScore)
.then(() => {
console.log('Score saved to today scores in Firebase');
// Also save to localStorage for backup
saveToLocalStorage(dateStr, newScore);
})
.catch((error) => {
console.error('Error saving score to Firebase:', error);
// Still save to localStorage even if Firebase fails
saveToLocalStorage(dateStr, newScore);
});
}
})
.catch((error) => {
console.error('Error checking existing scores:', error);
// Still save to localStorage even if Firebase fails
saveToLocalStorage(dateStr, newScore);
});
}

function saveToLocalStorage(dateStr, scoreData) {
try {
// Get existing scores from localStorage
let localScores = JSON.parse(localStorage.getItem('paidLeaderboardScores') || '{}');

// Initialize date array if it doesn't exist
if (!localScores[dateStr]) {
localScores[dateStr] = [];
}

// Check if user already has a score for today
const existingScoreIndex = localScores[dateStr].findIndex(s => s.userId === scoreData.userId);

if (existingScoreIndex === -1) {
// Add new score
localScores[dateStr].push(scoreData);

// Sort scores by score (descending)
localScores[dateStr].sort((a, b) => b.score - a.score);

// Keep only top 50 scores
localScores[dateStr] = localScores[dateStr].slice(0, 50);

// Save back to localStorage
localStorage.setItem('paidLeaderboardScores', JSON.stringify(localScores));

console.log('Score saved to localStorage');
}
} catch (error) {
console.error('Error saving to localStorage:', error);
}
}

function toggleLeaderboard() {
// Prevent double clicks
if (leaderboardToggleState) return;
leaderboardToggleState = true;

const leaderboardSection = document.getElementById('leaderboard-section');
const welcomeSection = document.getElementById('welcome-section');
const quizSection = document.getElementById('quiz-section');

if (leaderboardSection.style.display === 'none' || leaderboardSection.style.display === '') {
welcomeSection.style.display = 'none';
quizSection.style.display = 'none'; // Make sure quiz section is hidden
leaderboardSection.style.display = 'block';
loadLeaderboardData();
} else {
leaderboardSection.style.display = 'none';
welcomeSection.style.display = 'block';
// Don't show quiz section here, only show welcome section
}

// Reset the toggle state after a short delay
setTimeout(() => {
leaderboardToggleState = false;
}, 500);
}

function goToLeaderboard() {
const scoreSection = document.getElementById('score-section');
const quizSection = document.getElementById('quiz-section');
const leaderboardSection = document.getElementById('leaderboard-section');

if (scoreSection) {
scoreSection.style.display = 'none';
}

if (quizSection) {
quizSection.style.display = 'none'; // Make sure quiz section is hidden
}

// Reset quizStarted flag when going to leaderboard
quizStarted = false;

if (leaderboardSection) {
leaderboardSection.style.display = 'block';
loadLeaderboardData();
}
}

function showMyScore() {
if (!userName || !userId) {
checkUserName();
return;
}

// Find user's score in today's scores
let scores = [...todayScores];
scores.sort((a, b) => b.score - a.score);

const userScore = scores.find(s => s.userId === userId);

if (userScore) {
const percentage = ((userScore.score / userScore.totalQuestions) * 100).toFixed(1);
showNotification('success', '‡§Ü‡§™‡§ï‡§æ ‡§∏‡•ç‡§ï‡•ã‡§∞', `${userScore.score}/${userScore.totalQuestions} (${percentage}%)`);
} else {
showNotification('info', '‡§∏‡•Ç‡§ö‡§®‡§æ', '‡§Ü‡§™‡§®‡•á ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡•á‡§≤‡§æ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ñ‡•á‡§≤‡•á‡§Ç‡•§');
}
}

function showMyRank() {
if (!userName || !userId) {
checkUserName();
return;
}

// Find user's rank in today's scores
let scores = [...todayScores];
scores.sort((a, b) => b.score - a.score);

const userRank = scores.findIndex(s => s.userId === userId) + 1;

if (userRank > 0) {
showNotification('info', '‡§Ü‡§™‡§ï‡•Ä ‡§∞‡•à‡§Ç‡§ï', `‡§Ü‡§™‡§ï‡•Ä ‡§∞‡•à‡§Ç‡§ï: ${userRank}`);
} else {
showNotification('info', '‡§∏‡•Ç‡§ö‡§®‡§æ', '‡§Ü‡§™‡§®‡•á ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§®‡§π‡•Ä‡§Ç ‡§ñ‡•á‡§≤‡§æ ‡§π‡•à‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§™‡§π‡§≤‡•á ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§ñ‡•á‡§≤‡•á‡§Ç‡•§');
}
}

function showNotification(type, title, message) {
// Clear any existing timeout
if (notificationTimeout) {
clearTimeout(notificationTimeout);
}

const notificationOverlay = document.getElementById('notification-overlay');
const notification = document.getElementById('notification');
const notificationIcon = document.getElementById('notification-icon');
const notificationTitle = document.getElementById('notification-title');
const notificationMessage = document.getElementById('notification-message');

// Set icon based on type
if (type === 'success') {
notificationIcon.className = 'notification-icon success';
notificationIcon.innerHTML = '<i class="fas fa-check"></i>';
} else if (type === 'warning') {
notificationIcon.className = 'notification-icon warning';
notificationIcon.innerHTML = '<i class="fas fa-exclamation-triangle"></i>';
} else {
notificationIcon.className = 'notification-icon info';
notificationIcon.innerHTML = '<i class="fas fa-info"></i>';
}

notificationTitle.textContent = title;
notificationMessage.textContent = message;

// Show notification
notificationOverlay.style.display = 'flex';
setTimeout(() => {
notification.classList.add('show');
}, 10);

// Auto hide after exactly 3 seconds
notificationTimeout = setTimeout(() => {
hideNotification();
}, 3000);
}

function hideNotification() {
const notificationOverlay = document.getElementById('notification-overlay');
const notification = document.getElementById('notification');

notification.classList.remove('show');
setTimeout(() => {
notificationOverlay.style.display = 'none';
}, 300);
}

function loadLeaderboardData() {
const loadingSpinner = document.getElementById('leaderboard-loading');
const leaderboardList = document.getElementById('leaderboard-list');

// Show loading spinner
loadingSpinner.style.display = 'flex';
leaderboardList.innerHTML = '';

// Show skeleton loading
showSkeletonLoading();

// Get current date in YYYY-MM-DD format
const today = new Date();
const dateStr = today.toISOString().split('T')[0];

// Try to load from Firebase first
database.ref(`paidTodayScores/${dateStr}`).once('value')
.then((snapshot) => {
todayScores = [];
if (snapshot.exists()) {
const data = snapshot.val();
Object.keys(data).forEach(key => {
todayScores.push({
id: key,
...data[key]
});
});

// Also update localStorage with Firebase data
localStorage.setItem('paidLeaderboardScores', JSON.stringify({
[dateStr]: todayScores
}));
} else {
// If no data in Firebase, try to load from localStorage
loadFromLocalStorage(dateStr);
}

// Hide loading spinner
loadingSpinner.style.display = 'none';

// Display leaderboard
displayLeaderboard();
})
.catch((error) => {
console.error('Error loading leaderboard data from Firebase:', error);
// If Firebase fails, try to load from localStorage
loadFromLocalStorage(dateStr);

// Hide loading spinner
loadingSpinner.style.display = 'none';

// Display leaderboard
displayLeaderboard();
});
}

function showSkeletonLoading() {
const leaderboardList = document.getElementById('leaderboard-list');
if (!leaderboardList) return;

// Clear existing content
leaderboardList.innerHTML = '';

// Create skeleton items
for (let i = 0; i < 5; i++) {
const skeletonItem = document.createElement('div');
skeletonItem.className = 'skeleton-item';
skeletonItem.innerHTML = `
<div class="skeleton-rank"></div>
<div class="leaderboard-user">
<div class="skeleton-avatar"></div>
<div class="skeleton-details">
<div class="skeleton-name"></div>
<div class="skeleton-time"></div>
</div>
</div>
<div class="skeleton-score">
<div class="skeleton-value"></div>
<div class="skeleton-percentage"></div>
</div>
`;
leaderboardList.appendChild(skeletonItem);
}
}

function loadFromLocalStorage(dateStr) {
try {
const localScores = JSON.parse(localStorage.getItem('paidLeaderboardScores') || '{}');
if (localScores[dateStr]) {
todayScores = localScores[dateStr];
console.log('Loaded scores from localStorage');
} else {
todayScores = [];
console.log('No scores found in localStorage');
}
} catch (error) {
console.error('Error loading from localStorage:', error);
todayScores = [];
}
}

function displayLeaderboard() {
const leaderboardList = document.getElementById('leaderboard-list');
const currentUserRank = document.getElementById('current-user-rank');
const leaderboardDivider = document.getElementById('leaderboard-divider');
const championsSection = document.getElementById('champions-section');

leaderboardList.innerHTML = '';

let scores = [...todayScores];

// Sort scores by score (descending)
scores.sort((a, b) => b.score - a.score);

// Find current user's rank
let currentUserRankValue = -1;
if (userId) {
currentUserRankValue = scores.findIndex(s => s.userId === userId) + 1;
}

// Display current user's rank if found
if (currentUserRankValue > 0 && currentUserRank) {
currentUserRank.style.display = 'flex';
document.getElementById('current-user-name').textContent = userName;
document.getElementById('current-user-score').textContent = `‡§∏‡•ç‡§ï‡•ã‡§∞: ${scores[currentUserRankValue-1].score}/${scores[currentUserRankValue-1].totalQuestions}`;
document.getElementById('current-user-rank-badge').textContent = currentUserRankValue;

// Show divider and champions section
leaderboardDivider.style.display = 'flex';
championsSection.style.display = 'block';
} else if (currentUserRank) {
currentUserRank.style.display = 'none';

// Hide divider if user not found
leaderboardDivider.style.display = 'none';
championsSection.style.display = 'none';
}

// Display top 50 scores
const topScores = scores.slice(0, 50);

if (topScores.length === 0) {
leaderboardList.innerHTML = '<li class="leaderboard-empty">‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</li>';
return;
}

topScores.forEach((score, index) => {
const li = document.createElement('li');
li.className = 'leaderboard-item';

// Highlight current user
if (score.userId === userId) {
li.classList.add('current-user');
}

// Determine rank class
let rankClass = 'rank-other';
if (index === 0) rankClass = 'rank-1';
else if (index === 1) rankClass = 'rank-2';
else if (index === 2) rankClass = 'rank-3';

// Calculate time ago with improved accuracy
const timeAgo = getTimeAgo(score.timestamp);
const percentage = ((score.score / score.totalQuestions) * 100).toFixed(1);

// Add first-time badge if applicable
const firstTimeBadge = score.isFirstTime ? '<span class="first-time-badge">First Time</span>' : '';

li.innerHTML = `
<div class="leaderboard-rank ${rankClass}">${index + 1}</div>
<div class="leaderboard-user">
<div class="leaderboard-avatar">${score.name.charAt(0).toUpperCase()}</div>
<div class="leaderboard-details">
<div class="leaderboard-name">${score.name}${firstTimeBadge}</div>
<div class="leaderboard-time">${timeAgo}</div>
</div>
</div>
<div class="leaderboard-score">
<div class="score-value">${score.score}/${score.totalQuestions}</div>
<div class="score-percentage">${percentage}%</div>
</div>
`;

leaderboardList.appendChild(li);
});

// Update scroll indicators after content is loaded
if (scrollContent) {
setTimeout(() => {
updateScrollIndicators();
}, 100);
}
}

function getTimeAgo(timestamp) {
const now = Date.now();
const diff = now - timestamp;

// If less than a minute
if (diff < 60000) {
return '<span class="time-badge recent"><i class="fas fa-clock"></i> ‡§Ö‡§≠‡•Ä ‡§Ö‡§≠‡•Ä</span>';
}

// If less than an hour
if (diff < 3600000) {
const minutes = Math.floor(diff / 60000);
return `<span class="time-badge recent"><i class="fas fa-clock"></i> ${minutes} ‡§Æ‡§ø‡§®‡§ü ‡§™‡§π‡§≤‡•á</span>`;
}

// If less than a day
if (diff < 86400000) {
const hours = Math.floor(diff / 3600000);
return `<span class="time-badge"><i class="fas fa-clock"></i> ${hours} ‡§ò‡§Ç‡§ü‡•á ‡§™‡§π‡§≤‡•á</span>`;
}

// If more than a day
const days = Math.floor(diff / 86400000);
return `<span class="time-badge old"><i class="fas fa-calendar"></i> ${days} ‡§¶‡§ø‡§® ‡§™‡§π‡§≤‡•á</span>`;
}

function startCountdownTimer() {
// Clear any existing interval
if (countdownInterval) {
clearInterval(countdownInterval);
}

// Update the countdown every second
countdownInterval = setInterval(() => {
const now = new Date();
const tomorrow = new Date(now);
tomorrow.setDate(tomorrow.getDate() + 1);
tomorrow.setHours(0, 0, 0, 0);

const diff = tomorrow - now;

if (diff <= 0) {
// It's exactly midnight, reset everything immediately
clearInterval(countdownInterval);
resetLeaderboardAtMidnight();
// Restart the timer for the new day
setTimeout(() => {
startCountdownTimer();
}, 2000); // Wait 2 seconds before restarting
return;
}

const hours = Math.floor(diff / (1000 * 60 * 60));
const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
const seconds = Math.floor((diff % (1000 * 60)) / 1000);

const formattedTime = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

const countdownElement = document.getElementById('countdown-time');
if (countdownElement) {
countdownElement.textContent = formattedTime;
}

// Enhanced midnight detection - multiple checks for reliability
if (hours === 0 && minutes === 0 && seconds === 0) {
// It's exactly midnight (00:00:00)
clearInterval(countdownInterval);
resetLeaderboardAtMidnight();
// Restart the timer for the new day
setTimeout(() => {
startCountdownTimer();
}, 2000);
} else if (diff <= 3000) {
// Within 3 seconds of midnight - prepare for reset
console.log('Preparing for midnight reset in', diff, 'ms');
}
}, 1000);
}

function scheduleMidnightReset() {
// Clear any existing interval
if (midnightResetInterval) {
clearInterval(midnightResetInterval);
}

// Calculate time until midnight
const now = new Date();
const tomorrow = new Date(now);
tomorrow.setDate(tomorrow.getDate() + 1);
tomorrow.setHours(0, 0, 0, 0);

const timeUntilMidnight = tomorrow - now;

// Schedule reset at midnight
midnightResetInterval = setTimeout(() => {
resetLeaderboardAtMidnight();
// Schedule next day's reset
scheduleMidnightReset();
}, timeUntilMidnight);

console.log('Midnight reset scheduled in', timeUntilMidnight, 'ms');
}

function resetLeaderboardAtMidnight() {
console.log('MIDNIGHT RESET: Starting complete leaderboard reset');

// Get current date in YYYY-MM-DD format for new day
const today = new Date();
const todayStr = today.toISOString().split('T')[0];
const yesterday = new Date(today);
yesterday.setDate(yesterday.getDate() - 1);
const yesterdayStr = yesterday.toISOString().split('T')[0];

try {
// 1. Clear ALL localStorage leaderboard data
localStorage.removeItem('paidLeaderboardScores');
localStorage.removeItem('paidLastLeaderboardDate');
localStorage.removeItem('paidCachedLeaderboardData');

// 2. Reset the lastLeaderboardDate to today
localStorage.setItem('paidLastLeaderboardDate', todayStr);

// 3. Clear the today's scores array in memory
todayScores = [];

console.log('MIDNIGHT RESET: Cleared all localStorage data');

// 4. Clear Firebase data for yesterday (to keep database clean)
database.ref(`paidTodayScores/${yesterdayStr}`).remove()
.then(() => {
console.log('MIDNIGHT RESET: Cleared yesterday\'s Firebase data:', yesterdayStr);
})
.catch((error) => {
console.error('MIDNIGHT RESET: Error clearing yesterday\'s Firebase data:', error);
});

// 5. Show notification to users
showNotification('success', 'üåÖ ‡§®‡§Ø‡§æ ‡§¶‡§ø‡§® ‡§∂‡•Å‡§∞‡•Ç!', '‡§≤‡•Ä‡§°‡§∞‡§¨‡•ã‡§∞‡•ç‡§° ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à! ‡§Ü‡§ú ‡§ï‡•Ä ‡§®‡§à ‡§∞‡•à‡§Ç‡§ï‡§ø‡§Ç‡§ó ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§ó‡§à ‡§π‡•à‡•§');

// 6. If the leaderboard section is visible, reload it with empty data
const leaderboardSection = document.getElementById('leaderboard-section');
if (leaderboardSection && leaderboardSection.style.display === 'block') {
// Clear the leaderboard display
const leaderboardList = document.getElementById('leaderboard-list');
if (leaderboardList) {
leaderboardList.innerHTML = '<li class="leaderboard-empty">‡§®‡§è ‡§¶‡§ø‡§® ‡§ï‡•Ä ‡§∂‡•Å‡§∞‡•Å‡§Ü‡§§! ‡§Ö‡§≠‡•Ä ‡§ï‡•ã‡§à ‡§∏‡•ç‡§ï‡•ã‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à</li>';
}

// Hide user rank section
const currentUserRank = document.getElementById('current-user-rank');
const leaderboardDivider = document.getElementById('leaderboard-divider');
const championsSection = document.getElementById('champions-section');
if (currentUserRank) currentUserRank.style.display = 'none';
if (leaderboardDivider) leaderboardDivider.style.display = 'none';
if (championsSection) championsSection.style.display = 'none';
}

// 7. Update the leaderboard date display
const leaderboardDate = document.getElementById('leaderboard-date');
if (leaderboardDate) {
leaderboardDate.textContent = '‡§Ü‡§ú (‡§®‡§Ø‡§æ ‡§¶‡§ø‡§®)';
}

// 8. Trigger confetti for celebration
setTimeout(() => {
triggerConfetti();
}, 1000);

console.log('MIDNIGHT RESET: Complete! New day started:', todayStr);

} catch (error) {
console.error('MIDNIGHT RESET: Error during reset process:', error);
}
}

function checkAndResetLeaderboard() {
// Get current date in YYYY-MM-DD format
const today = new Date();
const todayStr = today.toISOString().split('T')[0];

// Get the last leaderboard date from localStorage
const lastDate = localStorage.getItem('paidLastLeaderboardDate');

// If it's a new day, reset the leaderboard
if (lastDate !== todayStr) {
console.log('NEW DAY DETECTED: Resetting leaderboard from', lastDate, 'to', todayStr);

// Clear todayScores array
todayScores = [];

// Update the last leaderboard date
localStorage.setItem('paidLastLeaderboardDate', todayStr);

// Clear any cached leaderboard data
localStorage.removeItem('paidCachedLeaderboardData');
localStorage.removeItem('paidLeaderboardScores');

console.log('NEW DAY RESET: Leaderboard data cleared for new day:', todayStr);

// If the leaderboard section is visible, reload it
const leaderboardSection = document.getElementById('leaderboard-section');
if (leaderboardSection && leaderboardSection.style.display === 'block') {
loadLeaderboardData();
}
}
}

function restartQuiz() {
// ‡§ï‡•ç‡§µ‡§ø‡§ú‡§º ‡§∞‡•Ä‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
if (!checkUserAccess()) {
return; // ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§µ‡•à‡§ß ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§∏‡•á ‡§¨‡§æ‡§π‡§∞ ‡§®‡§ø‡§ï‡§≤‡•á‡§Ç
}

quizStarted = false;
const quizSection = document.getElementById('quiz-section');
const scoreSection = document.getElementById('score-section');
const welcomeSection = document.getElementById('welcome-section');
if (quizSection && scoreSection && welcomeSection) {
scoreSection.style.display = 'none';
quizSection.style.display = 'none';
welcomeSection.style.display = 'block';
currentQuestionIndex = 0;
score = 0;
initialScore = 0; // Reset initial score
questionHistory = []; // Reset question history
quizCompleted = false; // Reset quiz completion flag
userAnswered = false; // Reset userAnswered flag
updateScore();
}
}

function showErrorOverlay() {
const errorOverlay = document.getElementById('error-overlay');
if (errorOverlay) {
errorOverlay.style.display = 'flex';
document.body.style.overflow = 'hidden';
}
}

function retry() {
quizStarted = false;
const errorOverlay = document.getElementById('error-overlay');
if (errorOverlay) {
errorOverlay.style.display = 'none';
document.body.style.overflow = 'hidden';
checkNetworkStatus();
if (navigator.onLine) {
loadQuestions().then(() => {
if (questions.length > 0) {
startQuiz();
}
});
}
}
}

// Check network status when page becomes visible again
document.addEventListener('visibilitychange', () => {
if (!document.hidden) {
checkNetworkStatus();
// ‡§™‡•á‡§ú ‡§µ‡§ø‡§ú‡§ø‡§¨‡§≤ ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
checkUserAccess();
}
});

// Handle page load when offline
window.addEventListener('load', () => {
if (!navigator.onLine) {
document.getElementById('offline-section').style.display = 'block';
document.getElementById('online-content').style.display = 'none';
}
// ‡§™‡•á‡§ú ‡§≤‡•ã‡§° ‡§π‡•ã‡§®‡•á ‡§™‡§∞ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
checkUserAccess();
});

window.onerror = function(message) {
console.error('Global error for paid quiz:', message);
showErrorOverlay();
return true;
};

window.addEventListener('online', checkNetworkStatus);
window.addEventListener('offline', checkNetworkStatus);

// ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function checkUserAccess() {
const accessData = localStorage.getItem('premiumAccess');

if (!accessData) {
// ‡§ï‡•ã‡§à ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§°‡•á‡§ü‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã index.html ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç
redirectToPayment();
return false;
}

try {
const { userId, mobileNumber, transactionId, expiryDate } = JSON.parse(accessData);
const now = new Date();
const expiry = new Date(expiryDate);

if (now >= expiry) {
// ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à ‡§π‡•à, localStorage ‡§∏‡•á ‡§π‡§ü‡§æ‡§è‡§Ç ‡§î‡§∞ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã index.html ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç
localStorage.removeItem('premiumAccess');
redirectToPayment();
return false;
}

// ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§µ‡•à‡§ß ‡§π‡•à
return true;
} catch (error) {
console.error('Access check error:', error);
// ‡§°‡•á‡§ü‡§æ ‡§™‡§æ‡§∞‡•ç‡§∏ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø, ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã index.html ‡§™‡§∞ ‡§≠‡•á‡§ú‡•á‡§Ç
redirectToPayment();
return false;
}
}

// ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function redirectToPayment() {
// ‡§è‡§ï ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç ‡§ï‡§ø ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à ‡§π‡•à
showAccessExpiredNotification();

// 3 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§ï‡•ã index.html ‡§™‡§∞ ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§ï‡§∞‡•á‡§Ç
setTimeout(() => {
if (window.AppInventor) {
// Kodular APK ‡§ï‡•á ‡§≤‡§ø‡§è
window.AppInventor.setWebViewString('file:///android_asset/index.html');
} else {
// ‡§µ‡•á‡§¨ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§ï‡•á ‡§≤‡§ø‡§è
window.location.href = 'file:///android_asset/index.html';
}
}, 3000);
}

// ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡§ø ‡§∏‡•Ç‡§ö‡§®‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
function showAccessExpiredNotification() {
// ‡§Ø‡§¶‡§ø ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§ï‡•ã‡§à ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à, ‡§§‡•ã ‡§¨‡§®‡§æ‡§è‡§Ç
let notificationContainer = document.getElementById('notification-container');
if (!notificationContainer) {
notificationContainer = document.createElement('div');
notificationContainer.id = 'notification-container';
notificationContainer.style.position = 'fixed';
notificationContainer.style.top = '20px';
notificationContainer.style.left = '50%';
notificationContainer.style.transform = 'translateX(-50%)';
notificationContainer.style.zIndex = '3000';
notificationContainer.style.width = '90%';
notificationContainer.style.maxWidth = '400px';
document.body.appendChild(notificationContainer);
}

// ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü ‡§¨‡§®‡§æ‡§è‡§Ç
const notification = document.createElement('div');
notification.style.background = 'white';
notification.style.borderRadius = '12px';
notification.style.padding = '16px';
notification.style.marginBottom = '10px';
notification.style.boxShadow = '0 4px 20px rgba(0, 0, 0, 0.15)';
notification.style.display = 'flex';
notification.style.alignItems = 'center';
notification.style.gap = '12px';
notification.style.animation = 'slideDown 0.3s ease-out';

notification.innerHTML = `
<div style="font-size: 24px; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; background: rgba(214, 48, 49, 0.1); color: #d63031;">
<i class="fas fa-exclamation-circle"></i>
</div>
<div style="flex: 1;">
<div style="font-weight: 600; font-size: 16px; margin-bottom: 4px; color: #2d3436;">
‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§
</div>
<div style="font-size: 14px; color: #666;">
‡§Ü‡§™‡§ï‡•Ä 30 ‡§¶‡§ø‡§® ‡§ï‡•Ä ‡§™‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ø‡§Æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§ ‡§π‡•ã ‡§ó‡§à ‡§π‡•à‡•§ ‡§Ü‡§™‡§ï‡•ã ‡§≠‡•Å‡§ó‡§§‡§æ‡§® ‡§™‡•É‡§∑‡•ç‡§† ‡§™‡§∞ ‡§∞‡•Ä‡§°‡§æ‡§Ø‡§∞‡•á‡§ï‡•ç‡§ü ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...
</div>
</div>
`;

// ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§ï‡§Ç‡§ü‡•á‡§®‡§∞ ‡§Æ‡•á‡§Ç ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
notificationContainer.appendChild(notification);

// 5 ‡§∏‡•á‡§ï‡§Ç‡§° ‡§¨‡§æ‡§¶ ‡§®‡•ã‡§ü‡§ø‡§´‡§ø‡§ï‡•á‡§∂‡§® ‡§π‡§ü‡§æ‡§è‡§Ç
setTimeout(() => {
if (notification.parentNode) {
notification.style.animation = 'slideUpOut 0.3s ease-out forwards';
setTimeout(() => {
if (notification.parentNode) {
notificationContainer.removeChild(notification);
}
}, 300);
}
}, 5000);
}

// CSS ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§® ‡§ú‡•ã‡§°‡§º‡•á‡§Ç
const style = document.createElement('style');
style.textContent = `
@keyframes slideDown {
from { transform: translateY(-100%); opacity: 0; }
to { transform: translateY(0); opacity: 1; }
}

@keyframes slideUpOut {
from { transform: translateY(0); opacity: 1; }
to { transform: translateY(-20px); opacity: 0; }
}
`;
document.head.appendChild(style);

// ‡§π‡§∞ 5 ‡§Æ‡§ø‡§®‡§ü ‡§Æ‡•á‡§Ç ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§ú‡§æ‡§Ç‡§ö‡•á‡§Ç
setInterval(checkUserAccess, 5 * 60 * 1000);

// Premium Button Functions
function createParticles() {
const particlesContainer = document.getElementById('particles-container');
if (!particlesContainer) return;

// Create 10 particles
for (let i = 0; i < 10; i++) {
const particle = document.createElement('div');
particle.className = 'particle';

// Random size between 2-6px
const size = Math.random() * 4 + 2;
particle.style.width = `${size}px`;
particle.style.height = `${size}px`;

// Random position
const posX = Math.random() * 100;
const posY = Math.random() * 100;
particle.style.left = `${posX}%`;
particle.style.top = `${posY}%`;

// Random animation delay
const delay = Math.random() * 5;
particle.style.animationDelay = `${delay}s`;

// Add to container
particlesContainer.appendChild(particle);

// Animate particle
animateParticle(particle);
}
}

function animateParticle(particle) {
// Random movement parameters
const moveX = (Math.random() - 0.5) * 40;
const moveY = (Math.random() - 0.5) * 40;
const duration = Math.random() * 3 + 2;

// Apply animation
particle.style.transition = `all ${duration}s ease-in-out`;
particle.style.opacity = '0.7';

// Start animation after a delay
setTimeout(() => {
particle.style.transform = `translate(${moveX}px, ${moveY}px)`;
particle.style.opacity = '0';
}, 100);

// Reset animation after completion
setTimeout(() => {
particle.style.transition = 'none';
particle.style.transform = 'translate(0, 0)';
particle.style.opacity = '0';

// Restart animation
setTimeout(() => {
animateParticle(particle);
}, 100);
}, (duration + 1) * 1000);
}

function handlePremiumBtnClick() {
// Prevent multiple clicks during rotation
if (isRotating) return;
isRotating = true;

const btn = document.getElementById('premium-rotating-btn');

// Add rotating class
btn.classList.add('rotating');

// Play fireworks sound
try {
fireworksSound.play().catch(e => console.log('Fireworks sound play failed:', e));
} catch (e) {
console.log('Fireworks sound creation failed:', e);
}

// After animation completes
setTimeout(() => {
// Remove rotating class
btn.classList.remove('rotating');

// Navigate to leaderboard
goToLeaderboard();

// Reset rotating flag
isRotating = false;

// Trigger starburst animation instead of confetti
triggerStarburst();
}, 1200);
}

function triggerStarburst() {
const container = document.getElementById('starburst-container');
container.innerHTML = '';
container.style.display = 'block';

// Create multiple starbursts from different positions
const positions = [
{ x: 20, y: 20 },
{ x: 80, y: 20 },
{ x: 50, y: 50 },
{ x: 20, y: 80 },
{ x: 80, y: 80 }
];

positions.forEach(pos => {
createStarburst(pos.x, pos.y);
});

// Hide container after animation completes
setTimeout(() => {
container.style.display = 'none';
}, 2000);
}

function createStarburst(xPercent, yPercent) {
const container = document.getElementById('starburst-container');
const colors = ['#FFD700', '#FF9500', '#FF5E3A', '#FF9500', '#FFD700'];

// Create multiple particles for each starburst
for (let i = 0; i < 30; i++) {
const star = document.createElement('div');
star.className = 'starburst';

// Random color
const color = colors[Math.floor(Math.random() * colors.length)];
star.style.background = color;
star.style.boxShadow = `0 0 10px 2px ${color}`;

// Random size
const size = Math.random() * 6 + 2;
star.style.width = `${size}px`;
star.style.height = `${size}px`;

// Position at the center point
star.style.left = `${xPercent}%`;
star.style.top = `${yPercent}%`;

// Random direction
const angle = (Math.PI * 2 * i) / 30;
const velocity = 50 + Math.random() * 100;
const tx = Math.cos(angle) * velocity;
const ty = Math.sin(angle) * velocity;

// Set CSS variables for animation
star.style.setProperty('--tx', `${tx}px`);
star.style.setProperty('--ty', `${ty}px`);

// Add animation
star.style.animation = 'starburstAnimation 1.5s ease-out forwards';

// Add to container
container.appendChild(star);
}
}
</script>
</body>
</html>
